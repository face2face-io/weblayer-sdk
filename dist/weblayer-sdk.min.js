/*! For license information please see weblayer-sdk.min.js.LICENSE.txt */
(()=>{"use strict";const e={apiUrl:"https://api.weblayer.ai",debug:!1,org_id:null,weblayerEnabled:!0};function t(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:365,i=(n=window.location.hostname,(r=n.split(".")).length<=1?n:"."+r.slice(-2).join(".")),a=new Date;a.setTime(a.getTime()+24*o*60*60*1e3);var s="".concat(e,"=").concat(t,"; expires=").concat(a.toUTCString(),"; domain=").concat(i,"; path=/; SameSite=Lax");document.cookie=s}function n(){var e,n,r="weblayer_visitor_id",o="weblayer_visitor_id",i=(e=r,2===(n="; ".concat(document.cookie).split("; ".concat(e,"="))).length?n.pop().split(";").shift():null);if(i){try{localStorage.setItem(o,i)}catch(e){}return i}try{if(i=localStorage.getItem(o))return t(r,i),i}catch(e){}i="".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,15));try{t(r,i),localStorage.setItem(o,i)}catch(e){}return i}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function s(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,l=Object.create(s.prototype);return a(l,"_invoke",function(n,r,o){var i,a,s,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,s=e,f.n=n,c}};function p(n,r){for(a=n,s=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(a=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,a=0))}if(o||n>1)return c;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),a=l,s=v;(t=a<2?e:s)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,s)):f.n=s:f.v=s);try{if(u=2,i){if(a||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==c)break}catch(t){i=e,a=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),l}var c={};function u(){}function l(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(a(t={},r,function(){return this}),t),p=d.prototype=u.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,a(p,"constructor",d),a(d,"constructor",l),l.displayName="GeneratorFunction",a(d,o,"GeneratorFunction"),a(p),a(p,o,"Generator"),a(p,r,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:s,m:v}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){function i(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},a(e,t,n,r)}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})}}var l=[],d=null;function f(e){l.push(e);var t=JSON.stringify(l).length;l.length>=50||t>=65536?v():d||(d=setTimeout(v,5e3))}var p=window.fetch;function v(){return h.apply(this,arguments)}function h(){return(h=u(i().m(function t(){var n;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:if(l.length){t.n=1;break}return t.a(2);case 1:return n=l,l=[],clearTimeout(d),d=null,t.p=2,t.n=3,p("".concat(e.apiUrl,"/sdk/events"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:n})});case 3:t.n=5;break;case 4:t.p=4,t.v;case 5:return t.a(2)}},t,null,[[2,4]])}))).apply(this,arguments)}function m(){return(new Date).toISOString()}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;return e?String(e).replace(/\s+/g," ").slice(0,t):null}function g(t){if(e.weblayerEnabled&&t&&e.org_id){var n=sessionStorage.getItem("weblayer_session_id");n||(n="".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2)),sessionStorage.setItem("weblayer_session_id",n)),f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:n,page_url:window.location.href,referrer:document.referrer||null,event_type:"navigation",event_name:"load",event_data:{title:document.title}}),window.addEventListener("error",function(r){var o=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"error",event_name:"window.onerror",event_data:{message:r.message,filename:r.filename,lineno:r.lineno,colno:r.colno}})}),window.addEventListener("unhandledrejection",function(r){var o=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"error",event_name:"unhandledrejection",event_data:{message:y(r.reason&&(r.reason.message||String(r.reason)))}})}),document.addEventListener("invalid",function(r){var o=sessionStorage.getItem("weblayer_session_id")||n,i=r.target;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"validation_error",event_name:"invalid",event_data:{element:i.tagName.toLowerCase(),type:i.type||null,name:i.name||null,id:i.id||null,validation_message:i.validationMessage||null,value_length:(i.value||"").length}})},!0);var o=new WeakMap,a=new WeakMap;document.addEventListener("focus",function(e){return R("focus",e)},!0),document.addEventListener("blur",function(e){return R("blur",e)},!0),document.addEventListener("input",function(e){return R("input",e)},!0),document.addEventListener("change",function(e){return R("change",e)},!0),document.addEventListener("submit",function(r){try{var i=r.target;if(!i||"FORM"!==i.tagName)return;var a=sessionStorage.getItem("weblayer_session_id")||n,s=o.get(i),c=s?Date.now()-s:null,u=i.querySelectorAll("input, textarea, select").length;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:a,page_url:window.location.href,referrer:document.referrer||null,event_type:"form_interaction",event_name:"submit",event_data:{form_id:i.id||null,field_count:u,completion_time_ms:c}}),o.delete(i)}catch(r){e.debug&&console.warn("[weblayer] Failed to track form submit:",r)}},!0),document.addEventListener("focus",function(e){try{var t=e.target;if(!t||!t.tagName)return;var n=t.tagName.toLowerCase();if(!["input","textarea","select"].includes(n))return;var r=t.closest("form");r&&!o.has(r)&&o.set(r,Date.now())}catch(e){}},!0),document.addEventListener("focusin",function(r){try{var o=r.target,i=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"focus",event_name:"focusin",event_data:{target_tag:o&&o.tagName?o.tagName.toLowerCase():null,target_id:o&&o.id||null,target_classes:o&&o.className||null}})}catch(r){e.debug&&console.warn("[weblayer] Failed to track focusin:",r)}},!0),document.addEventListener("focusout",function(r){try{var o=r.target,i=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"focus",event_name:"focusout",event_data:{target_tag:o&&o.tagName?o.tagName.toLowerCase():null,target_id:o&&o.id||null,target_classes:o&&o.className||null}})}catch(r){e.debug&&console.warn("[weblayer] Failed to track focusout:",r)}},!0);var c=console.error,d=console.warn;console.error=function(){try{var r=sessionStorage.getItem("weblayer_session_id")||n,o=Array.from(arguments).map(function(e){return"object"===s(e)?JSON.stringify(e):String(e)}).join(" ");f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"console",event_name:"error",event_data:{message:y(o,500)}})}catch(e){}return c.apply(console,arguments)},console.warn=function(){try{var r=sessionStorage.getItem("weblayer_session_id")||n,o=Array.from(arguments).map(function(e){return"object"===s(e)?JSON.stringify(e):String(e)}).join(" ");f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"console",event_name:"warn",event_data:{message:y(o,500)}})}catch(e){}return d.apply(console,arguments)};var p=window.fetch;p.__weblayerWrapped||(window.fetch=function(){var r=u(i().m(function r(o,a){var s,c,u,l,d,v,h,g,w,b=arguments;return i().w(function(r){for(;;)switch(r.p=r.n){case 0:if(!b[0]||"string"!=typeof b[0]||!b[0].includes("/sdk/events")){r.n=1;break}return r.a(2,p.apply(this,b));case 1:return s=performance.now(),c="string"==typeof o?o:o instanceof Request?o.url:String(o),u=a&&a.method||o instanceof Request&&o.method||"GET",r.p=2,r.n=3,p.apply(this,b);case 3:l=r.v,d=Math.round(performance.now()-s),v=sessionStorage.getItem("weblayer_session_id")||n;try{f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:v,page_url:window.location.href,referrer:document.referrer||null,event_type:"network",event_name:u,event_data:{url:c,method:u},status:l.status,duration_ms:d})}catch(t){e.debug&&console.warn("[weblayer] Failed to track fetch:",t)}return r.a(2,l);case 4:r.p=4,w=r.v,h=Math.round(performance.now()-s),g=sessionStorage.getItem("weblayer_session_id")||n;try{f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:g,page_url:window.location.href,referrer:document.referrer||null,event_type:"network",event_name:u,event_data:{url:c,method:u,error:y(w&&w.message)},status:0,duration_ms:h})}catch(t){e.debug&&console.warn("[weblayer] Failed to track fetch error:",t)}throw w;case 5:return r.a(2)}},r,this,[[2,4]])}));return function(e,t){return r.apply(this,arguments)}}(),window.fetch.__weblayerWrapped=!0,window.fetch.toString=function(){return p.toString()});var h=XMLHttpRequest.prototype.open,g=XMLHttpRequest.prototype.send;h.__weblayerWrapped||(XMLHttpRequest.prototype.open=function(e,t){return this._weblayerMethod=e,this._weblayerUrl=t,this._weblayerSkip="string"==typeof t&&t.includes("/sdk/events"),h.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){if(this._weblayerSkip)return g.apply(this,arguments);var r=performance.now(),o=this._weblayerMethod||"GET",i=this._weblayerUrl||"";return this.addEventListener("loadend",function(){try{var a=Math.round(performance.now()-r),s=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:s,page_url:window.location.href,referrer:document.referrer||null,event_type:"network",event_name:o,event_data:{url:i,method:o},status:this.status||0,duration_ms:a})}catch(t){e.debug&&console.warn("[weblayer] Failed to track XHR:",t)}}),g.apply(this,arguments)},XMLHttpRequest.prototype.open.__weblayerWrapped=!0,XMLHttpRequest.prototype.send.__weblayerWrapped=!0);var w=new WeakSet;if(function(){try{var t=document.querySelectorAll("video"),n=document.querySelectorAll("audio");t.forEach(function(e){return Y(e)}),n.forEach(function(e){return Y(e)})}catch(t){e.debug&&console.warn("[weblayer] Failed to track existing media:",t)}}(),"undefined"!=typeof MutationObserver){var b=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){if(1===e.nodeType){"VIDEO"!==e.tagName&&"AUDIO"!==e.tagName||Y(e);var t=e.querySelectorAll?e.querySelectorAll("video"):[],n=e.querySelectorAll?e.querySelectorAll("audio"):[];t.forEach(function(e){return Y(e)}),n.forEach(function(e){return Y(e)})}})})});try{b.observe(document.body,{childList:!0,subtree:!0})}catch(t){e.debug&&console.warn("[weblayer] Failed to set up media observer:",t)}}document.addEventListener("click",function(r){var o=r.target;if(o&&o.tagName){var i=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"click",event_name:o.tagName.toLowerCase(),event_data:{id:o.id||null,classes:o.className||null,text:y(o.textContent)}});var a=window.location.href,s=l.length,c=Date.now(),u=!1,d=setInterval(function(){l.length>s&&(u=!0,clearInterval(d))},50),p=function(){u=!0};document.addEventListener("focusin",p,{once:!0,capture:!0});var v=function(){clearInterval(d),document.removeEventListener("focusin",p,!0)},h=function(){try{var e=document.body.innerText.slice(0,1e3),t=document.querySelectorAll('[role="dialog"], .modal, .popup').length,n=document.querySelectorAll('[class*="loading"], [class*="spinner"], [class*="Loading"], [class*="Spinner"], [aria-busy="true"], [data-loading="true"], svg[class*="spin"], svg[class*="rotate"]').length,r=document.querySelectorAll("button:disabled, input:disabled").length,i="";try{if(!o||!o.isConnected)return"element-removed";i="".concat(o.className,"-").concat(o.disabled,"-").concat(o.getAttribute("aria-busy"))}catch(e){return"element-removed"}return"".concat(e.length,"-").concat(t,"-").concat(n,"-").concat(r,"-").concat(i)}catch(e){return"error"}},g=h(),w=function(r){try{var i=window.location.href!==a,s=h();if(i||g!==s||u)return void v();if(2===r){v();var l=window.getComputedStyle(o),d=!(!o.onclick&&!o.getAttribute("onclick")),p=l.cursor,w=["A","BUTTON","INPUT","SELECT","TEXTAREA"].includes(o.tagName),b="LABEL"===o.tagName&&o.htmlFor,_="A"===o.tagName&&o.href&&"#"!==o.href&&!o.href.startsWith("javascript:"),S=["INPUT","SELECT","TEXTAREA"].includes(o.tagName);if(w&&!b&&!S||d&&!_||"pointer"===p&&!b){var E=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:E,page_url:window.location.href,referrer:document.referrer||null,event_type:"dead_click",event_name:"no_response",event_data:{element:{tag:o.tagName.toLowerCase(),id:o.id||null,classes:o.className||null,text:y(o.textContent),href:o.href||null},context:{expected_interactive:w,has_click_handler:d,cursor_style:p,time_since_click:Date.now()-c}}})}}}catch(t){e.debug&&console.warn("[weblayer] Dead-click detection failed:",t)}};setTimeout(function(){return w(1)},500),setTimeout(function(){return w(2)},1500)}},{capture:!0});var _=new WeakMap,S=null;document.addEventListener("mouseenter",function(r){try{var o=r.target;if(!o||!o.tagName)return;var i=Date.now();_.set(o,i),clearTimeout(S),S=setTimeout(function(){var r=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"hover",event_name:"mouseenter",event_data:{target_tag:o.tagName.toLowerCase(),target_id:o.id||null,target_classes:o.className||null}})},100)}catch(r){e.debug&&console.warn("[weblayer] Failed to track mouseenter:",r)}},{capture:!0}),document.addEventListener("mouseleave",function(r){try{var o=r.target;if(!o||!o.tagName)return;var i=_.get(o),a=i?Date.now()-i:null,s=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:s,page_url:window.location.href,referrer:document.referrer||null,event_type:"hover",event_name:"mouseleave",event_data:{target_tag:o.tagName.toLowerCase(),target_id:o.id||null,target_classes:o.className||null,duration_ms:a}}),_.delete(o)}catch(r){e.debug&&console.warn("[weblayer] Failed to track mouseleave:",r)}},{capture:!0});var E=null;document.addEventListener("mouseover",function(r){try{var o=r.target;if(!o||!o.tagName)return;var i=o.tagName.toLowerCase();if(!(["a","button","input","select","textarea"].includes(i)||"button"===o.getAttribute("role")||null!==o.getAttribute("tabindex")))return;clearTimeout(E),E=setTimeout(function(){var r=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"hover",event_name:"hover",event_data:{target_tag:i,target_id:o.id||null,target_classes:o.className||null}})},100)}catch(r){e.debug&&console.warn("[weblayer] Failed to track mouseover:",r)}},{capture:!0});var k=null;document.addEventListener("touchstart",function(r){try{var o=sessionStorage.getItem("weblayer_session_id")||n,i=r.touches[0],a=r.target;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"touch",event_name:"touchstart",event_data:{x:i?i.clientX:null,y:i?i.clientY:null,target_id:a&&a.id||null,target_tag:a&&a.tagName?a.tagName.toLowerCase():null,target_classes:a&&a.className||null,touches_count:r.touches.length}})}catch(r){e.debug&&console.warn("[weblayer] Failed to track touchstart:",r)}},{capture:!0}),document.addEventListener("touchend",function(r){try{var o=sessionStorage.getItem("weblayer_session_id")||n,i=r.changedTouches[0],a=r.target;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"touch",event_name:"touchend",event_data:{x:i?i.clientX:null,y:i?i.clientY:null,target_id:a&&a.id||null,target_tag:a&&a.tagName?a.tagName.toLowerCase():null,target_classes:a&&a.className||null,touches_count:r.changedTouches.length}})}catch(r){e.debug&&console.warn("[weblayer] Failed to track touchend:",r)}},{capture:!0}),document.addEventListener("touchmove",function(r){try{clearTimeout(k),k=setTimeout(function(){var o=sessionStorage.getItem("weblayer_session_id")||n,i=r.touches[0],a=r.target;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"touch",event_name:"touchmove",event_data:{x:i?i.clientX:null,y:i?i.clientY:null,target_id:a&&a.id||null,target_tag:a&&a.tagName?a.tagName.toLowerCase():null,target_classes:a&&a.className||null,touches_count:r.touches.length}})},100)}catch(r){e.debug&&console.warn("[weblayer] Failed to track touchmove:",r)}},{capture:!0});var I=null,x=null,T=null,C=window.scrollX||0,A=window.scrollY||0,O=(Date.now(),null);window.addEventListener("scroll",function(){try{clearTimeout(I),clearTimeout(x),I=setTimeout(function(){var e=window.scrollX||window.pageXOffset||0,t=window.scrollY||window.pageYOffset||0,n=Date.now(),r=null;if(T){var o=t-A;Math.abs(o)>10&&(r=o>0?"down":"up")}T&&(Math.abs(t-A)>10||Math.abs(e-C)>10)&&W(),C=e,A=t,x=setTimeout(function(){var e=window.scrollX||window.pageXOffset||0,t=window.scrollY||window.pageYOffset||0;X(e,t,r||(t>(A||0)?"down":t<(A||0)?"up":null))},600)},150)}catch(t){e.debug&&console.warn("[weblayer] Failed to track scroll:",t)}},{passive:!0}),window.addEventListener("beforeunload",function(){W()}),document.addEventListener("visibilitychange",function(){document.hidden&&W()});var L=null;document.addEventListener("selectstart",function(r){try{var o=r.target,i=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"selection",event_name:"selectstart",event_data:{target_tag:o&&o.tagName?o.tagName.toLowerCase():null}})}catch(r){e.debug&&console.warn("[weblayer] Failed to track selectstart:",r)}},{capture:!0}),document.addEventListener("selectionchange",function(){try{clearTimeout(L),L=setTimeout(function(){try{var r=window.getSelection();if(!r||0===r.rangeCount)return;var o=r.getRangeAt(0),i=o.toString();if(!i||0===i.trim().length)return;var a=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:a,page_url:window.location.href,referrer:document.referrer||null,event_type:"selection",event_name:"selectionchange",event_data:{text_snippet:y(i,200),text_length:i.length,target_tag:o.commonAncestorContainer&&1===o.commonAncestorContainer.nodeType&&o.commonAncestorContainer.tagName?o.commonAncestorContainer.tagName.toLowerCase():null}})}catch(e){}},200)}catch(t){e.debug&&console.warn("[weblayer] Failed to track selectionchange:",t)}}),document.addEventListener("copy",function(r){try{var o=window.getSelection();if(!o||0===o.rangeCount)return;var i=o.getRangeAt(0),a=i.toString();if(!a||0===a.trim().length)return;var s=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:s,page_url:window.location.href,referrer:document.referrer||null,event_type:"selection",event_name:"copy",event_data:{text_snippet:y(a,200),text_length:a.length,target_tag:i.commonAncestorContainer&&1===i.commonAncestorContainer.nodeType&&i.commonAncestorContainer.tagName?i.commonAncestorContainer.tagName.toLowerCase():null}})}catch(r){e.debug&&console.warn("[weblayer] Failed to track copy:",r)}},{capture:!0});var j=history.pushState,P=history.replaceState;history.pushState=function(){W(),j.apply(this,arguments);var r=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"navigation",event_name:"pushstate",event_data:{title:document.title,state:arguments[0]}})},history.replaceState=function(){W(),P.apply(this,arguments);var r=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"navigation",event_name:"replacestate",event_data:{title:document.title,state:arguments[0]}})},window.addEventListener("popstate",function(r){W();var o=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"navigation",event_name:"popstate",event_data:{title:document.title,state:r.state}})});var N=null;window.addEventListener("resize",function(){try{clearTimeout(N),N=setTimeout(function(){var r=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"resize",event_name:"window_resize",event_data:{width:window.innerWidth,height:window.innerHeight}})},300)}catch(t){e.debug&&console.warn("[weblayer] Failed to track resize:",t)}}),window.addEventListener("beforeunload",function(){v()});Date.now();var D=0,F=0,B=Date.now(),M=null;document.addEventListener("visibilitychange",function(){try{K();var r=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"visibility",event_name:document.hidden?"hidden":"visible",event_data:{active_time_ms:D,inactive_time_ms:F}}),document.hidden?(v(),M&&(clearInterval(M),M=null)):(M&&clearInterval(M),M=setInterval(function(){try{K();var r=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"visibility",event_name:"active_time_update",event_data:{active_time_ms:D,inactive_time_ms:F}})}catch(t){e.debug&&console.warn("[weblayer] Failed to update visibility:",t)}},3e4))}catch(t){e.debug&&console.warn("[weblayer] Failed to track visibility:",t)}}),document.hidden||(B=Date.now(),M=setInterval(function(){try{K();var r=sessionStorage.getItem("weblayer_session_id")||n;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"visibility",event_name:"active_time_update",event_data:{active_time_ms:D,inactive_time_ms:F}})}catch(t){e.debug&&console.warn("[weblayer] Failed to update visibility:",t)}},3e4))}function R(r,o){try{var i=o.target;if(!i||!i.tagName)return;var s=i.tagName.toLowerCase();if(!["input","textarea","select"].includes(s))return;var c=sessionStorage.getItem("weblayer_session_id")||n,u={field_type:i.type||s,field_name:i.name||null,field_id:i.id||null,has_value:!!(i.value&&i.value.length>0),value_length:(i.value||"").length};"focus"===r&&a.set(i,Date.now()),f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:c,page_url:window.location.href,referrer:document.referrer||null,event_type:"form_interaction",event_name:r,event_data:u})}catch(o){e.debug&&console.warn("[weblayer] Failed to track form ".concat(r,":"),o)}}function Y(r){if(!w.has(r)&&(r.src||r.srcObject)){w.add(r);["play","pause","ended","seeking","timeupdate","volumechange","error"].forEach(function(o){r.addEventListener(o,function(r){try{var i=sessionStorage.getItem("weblayer_session_id")||n,a=r.target,s=a.src||(a.srcObject?"blob/object":null)||null;if(!s&&!a.srcObject)return;f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"media",event_name:o,event_data:{element_type:a.tagName.toLowerCase(),src:y(s,200),current_time:a.currentTime||null,duration:a.duration||null,volume:void 0!==a.volume?a.volume:null,muted:void 0!==a.muted?a.muted:null,paused:void 0!==a.paused?a.paused:null}})}catch(r){e.debug&&console.warn("[weblayer] Failed to track media ".concat(o,":"),r)}})})}}function X(t,n,o){try{var i=Date.now(),a=(sessionStorage.getItem("weblayer_session_id"),function(){try{var t=window.scrollY||window.pageYOffset||0,n=t+window.innerHeight,o=window.scrollX||window.pageXOffset||0,i=o+window.innerWidth,a=[],s=[],c=[];if("undefined"!=typeof IntersectionObserver)document.querySelectorAll('h1, h2, h3, h4, h5, h6, p, img, [role="heading"]').forEach(function(e){try{var r=e.getBoundingClientRect(),u=t+r.top,l=u+r.height,d=o+r.left,f=d+r.width;if(l>t&&u<n&&f>o&&d<i&&r.width>0&&r.height>0){var p=e.tagName?e.tagName.toLowerCase():"";if(p.match(/^h[1-6]$/)||"heading"===e.getAttribute("role")){var v=y(e.textContent||e.innerText,200);v&&a.push({level:p,text:v})}else if("img"===p){var h=y(e.alt,100),m=y(e.src,200);c.push({alt:h||null,src:m||null})}else if("p"===p||e.textContent){var g=y(e.textContent||e.innerText,300);if(g&&!s.includes(g)&&(s.push(g),s.join(" ").length>=1e3))return}}}catch(e){}});else{var u=t+window.innerHeight/2,l=o+window.innerWidth/2;[[l,u],[l,t+.25*window.innerHeight],[l,t+.75*window.innerHeight]].forEach(function(e){var n=r(e,2),i=n[0],c=n[1];try{var u=document.elementFromPoint(i-o,c-t);if(u){var l=u.tagName?u.tagName.toLowerCase():"";if(l.match(/^h[1-6]$/)){var d=y(u.textContent,200);d&&a.push({level:l,text:d})}else if(u.textContent){var f=y(u.textContent,300);f&&!s.includes(f)&&s.push(f)}}}catch(e){}})}return{headings:a.slice(0,10),text_snippets:s.slice(0,5),images:c.slice(0,5)}}catch(t){return e.debug&&console.warn("[weblayer] Failed to capture visible content:",t),{headings:[],text_snippets:[],images:[]}}}()),s={scroll_x:t,scroll_y:n,viewport_width:window.innerWidth,viewport_height:window.innerHeight,visible_content:a,scroll_direction:o,stop_time:i};T=s,O&&(clearInterval(O),O=null),O=setInterval(function(){if(T&&T.stop_time){var e=Date.now()-T.stop_time;T.duration_ms=e}},2e3)}catch(t){e.debug&&console.warn("[weblayer] Failed to record scroll stop:",t)}}function W(){if(T)try{var r=sessionStorage.getItem("weblayer_session_id")||n,o=Date.now()-(T.stop_time||Date.now());f({ts:m(),org_id:e.org_id,visitor_id:t,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"scroll",event_name:"scroll_stop",event_data:{scroll_x:T.scroll_x,scroll_y:T.scroll_y,viewport_width:T.viewport_width,viewport_height:T.viewport_height,visible_content:T.visible_content,scroll_direction:T.scroll_direction,duration_ms:o}}),T=null,O&&(clearInterval(O),O=null)}catch(t){e.debug&&console.warn("[weblayer] Failed to flush scroll stop:",t)}}function K(){var e=Date.now();document.hidden?F+=e-B:D+=e-B,B=e}}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}function E(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:t+""}var k=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elementCounter=0},t=[{key:"scan",value:function(){var e=this;this.elementCounter=0;var t=[],n=new Set;return["button","a[href]",'input[type="button"]','input[type="submit"]','input[type="reset"]','input[type="checkbox"]','input[type="radio"]','input[type="text"]','input[type="email"]','input[type="password"]','input[type="search"]','input[type="tel"]','input[type="url"]','input[type="number"]',"textarea","select",'[role="button"]','[role="link"]','[role="checkbox"]','[role="radio"]','[role="textbox"]','[role="combobox"]','[role="option"]',"[onclick]",'[tabindex]:not([tabindex="-1"])'].forEach(function(e){try{document.querySelectorAll(e).forEach(function(e){n.add(e)})}catch(e){}}),n.forEach(function(n){var r=e._extractElementData(n);r&&t.push(r)}),{elements:t,timestamp:Date.now(),url:window.location.href}}},{key:"_extractElementData",value:function(e){try{var t=this._isElementVisible(e),n=e.disabled||"true"===e.getAttribute("aria-disabled"),r=e.getBoundingClientRect(),o=r.top>=0&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth),i="";try{i=(i=e.textContent||e.innerText||"").replace(/\s+/g," ").trim().slice(0,100)}catch(e){}var a=e.tagName.toLowerCase(),s=e.id||null,c=e.className?String(e.className).split(/\s+/).filter(function(e){return e}).join(" "):null,u=e.type||null,l=e.href||null,d=e.placeholder||null,f=e.getAttribute("aria-label")||null,p=e.getAttribute("role")||null,v="wl-".concat(++this.elementCounter);return e.dataset.weblayerId||(e.dataset.weblayerId=v),{id:e.dataset.weblayerId||v,tag:a,text:i,id_attr:s,classes:c,type:u,href:l,placeholder:d,ariaLabel:f,role:p,visible:t&&o,hidden:!t,disabled:n,inViewport:o,position:{top:Math.round(r.top),left:Math.round(r.left),width:Math.round(r.width),height:Math.round(r.height)}}}catch(e){return console.warn("[ACB] Error extracting element data:",e),null}}},{key:"_isElementVisible",value:function(e){try{if(!e||!e.offsetParent)return!1;var t=window.getComputedStyle(e);if("none"===t.display||"hidden"===t.visibility||"0"===t.opacity)return!1;var n=e.getBoundingClientRect();return 0!==n.width||0!==n.height}catch(e){return!1}}},{key:"findElementById",value:function(e){var t=document.querySelector('[data-weblayer-id="'.concat(e,'"]'));if(t)return t;var n=this.scan().elements.find(function(t){return t.id===e});if(n){if(n.id_attr){var r=document.getElementById(n.id_attr);if(r)return r}if(n.text){var o,i=b(document.querySelectorAll(n.tag));try{for(i.s();!(o=i.n()).done;){var a=o.value;if((a.textContent||"").trim()===n.text&&this._isElementVisible(a))return a}}catch(e){i.e(e)}finally{i.f()}}}return null}}],t&&S(e.prototype,t),n&&S(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();const I=function(){var e={x:1,y:1},t=[],n=230*Math.random()+20,r=!0,o=null,i=null;function a(){if(!o){var e=document.createElement("div");e.id="virtualpointer-container",e.style.cssText="position: fixed;pointer-events: none;z-index: 999999;transform: translate(-50%, -50%);",(o=document.createElement("div")).id="virtualpointer-cursor",o.style.cssText="width: 20px;height: 20px;border-radius: 50%;background: rgba(59, 130, 246, 0.7);border: 2px solid rgba(255, 255, 255, 0.95);pointer-events: none;transition: all 0.1s ease-out;box-shadow: 0 0 15px rgba(59, 130, 246, 0.6);position: relative;";var t=document.createElement("div");t.id="virtualpointer-label",t.textContent="AI",t.style.cssText='position: absolute;top: -35px;left: 50%;transform: translateX(-50%);background: rgba(59, 130, 246, 0.95);color: white;padding: 4px 10px;border-radius: 12px;font-size: 11px;font-weight: 600;font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;white-space: nowrap;box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);letter-spacing: 0.5px;',(i=document.createElement("div")).id="virtualpointer-ripple",i.style.cssText="position: fixed;width: 10px;height: 10px;border-radius: 50%;background: rgba(59, 130, 246, 0.4);border: 2px solid rgba(59, 130, 246, 0.6);pointer-events: none;z-index: 999998;transform: translate(-50%, -50%) scale(0);opacity: 0;",o.appendChild(t),e.appendChild(o),document.body.appendChild(e),document.body.appendChild(i),o=e}}function s(t,n,a,s,c,u,l,d,f,p){if("scroll"!=t){u||(u=n+1),l||(l=a+30),function(e,t,n){if(r&&o)if(n){var i=n.getBoundingClientRect(),a=i.left+i.width/2,s=i.top+i.height/2;o.style.left=a+"px",o.style.top=s+"px"}else{var c=e-(window.pageXOffset||document.documentElement.scrollLeft),u=t-(window.pageYOffset||document.documentElement.scrollTop);o.style.left=c+"px",o.style.top=u+"px"}}(n,a,s),"click"!==t&&"mousedown"!==t&&"touchstart"!==t||function(e,t,n){if(r&&i){if(n){var o=n.getBoundingClientRect(),a=o.left+o.width/2,s=o.top+o.height/2;i.style.left=a+"px",i.style.top=s+"px"}else{var c=e-(window.pageXOffset||document.documentElement.scrollLeft),u=t-(window.pageYOffset||document.documentElement.scrollTop);i.style.left=c+"px",i.style.top=u+"px"}i.style.transition="none",i.style.transform="translate(-50%, -50%) scale(0)",i.style.opacity="1",i.offsetHeight,i.style.transition="all 0.4s ease-out",i.style.transform="translate(-50%, -50%) scale(4)",i.style.opacity="0"}}(n,a,s),c||"click"!==t&&"mousedown"!==t&&"mouseup"!==t||(c=0);var v,h="mousemove"!==t&&"touchmove"!==t?1:0;if(d&&("ontouchstart"in window||navigator.msMaxTouchPoints>0))(v=document.createEvent("TouchEvent")).initTouchEvent(t,!0,!0,window,h,u,l,n,a,!1,!1,!1,!1,c,null);else(v=document.createEvent("MouseEvent")).initMouseEvent(t,!0,!0,window,h,u,l,n,a,!1,!1,!1,!1,c,null);s?s.dispatchEvent(v):document.body.dispatchEvent(v),e={x:u,y:l}}else window.scrollTo(f,p)}function c(){if(t.length){var e=t[0],n=t[1];if(s(e.type,e.pageX,e.pageY,e.target,null,e.screenX,e.screenY,e.isTouchEvent,e.scrollLeft,e.scrollTop),n){var r=n.timestamp-e.timestamp;setTimeout(c,r)}t.shift()}}function u(e){var t=document.body.getBoundingClientRect(),n=e.getBoundingClientRect(),r=n.top-t.top;return{x:n.left-t.left,y:r}}function l(e,t){if(function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(e))t&&t();else{e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});var n=window.pageYOffset||document.documentElement.scrollTop,r=window.pageXOffset||document.documentElement.scrollLeft,o=function(){var e=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;e===n&&i===r?t&&t():(n=e,r=i,setTimeout(o,50))};setTimeout(o,100)}}function d(n,r){for(var o=u(n),i=o.x-e.x,a=o.y-e.y,s=r/20,c=1;c<=s;c++){var l=Math.round(i/s*c)+e.x,d=Math.round(a/s*c)+e.y;t.push({type:"mousemove",pageX:l,pageY:d,screenX:l+1,screenY:d+30,timestamp:20*c})}}function f(e,r,o){var i,a,s=u(e),c=t.length?t[t.length-1].timestamp:0;r||(r=n),o?(i=s.x,a=s.y,t.push({type:"touchstart",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c,target:e,isTouchEvent:!0}),t.push({type:"touchmove",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+Math.floor(n/2),target:e,isTouchEvent:!0}),t.push({type:"touchend",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+n,target:e,isTouchEvent:!0})):(i=s.x+1,a=s.y+30,t.push({type:"mouseover",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+n+10,target:e,isTouchEvent:!1}),t.push({type:"mousemove",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+n+20,target:e,isTouchEvent:!1}),t.push({type:"mousedown",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+n+20,target:e,isTouchEvent:!1}),t.push({type:"mouseup",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+2*n,target:e,isTouchEvent:!1}),t.push({type:"click",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+2*n+10,target:e,isTouchEvent:!1}))}function p(){r&&a(),setTimeout(c,50)}return{move_mouse_to_element:function(e,t){e&&l(e,function(){d(e,t),p()})},click_element:function(e){e&&l(e,function(){f(e),p()})},move_to_element_and_click:function(e,t){e&&l(e,function(){d(e,t),f(e),p()})},tap_element:function(e){e&&l(e,function(){f(e,null,!0),p()})},double_tap_element:function(e){e&&l(e,function(){f(e,null,!0),f(e,25,!0),p()})},flick_to_element:function(e,t){e&&l(e,function(){f(e,t,!0),p()})},run_serialized_events:function(e){e&&e instanceof Array&&(t=e,p())},show_cursor:function(){r=!0,a()},hide_cursor:function(){r=!1,o&&o.parentNode&&(o.parentNode.removeChild(o),o=null),i&&i.parentNode&&(i.parentNode.removeChild(i),i=null)}}}();function x(e){return e?new Promise(function(t,n){try{I&&I.show_cursor&&I.show_cursor(),I&&I.click_element?(I.click_element(e),setTimeout(function(){t({success:!0})},400)):n(new Error("VirtualPointer not available"))}catch(e){n(e)}}):Promise.reject(new Error("Element is required"))}function T(){I&&I.show_cursor&&I.show_cursor()}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function A(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return O(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(O(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,O(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,O(d,"constructor",u),O(u,"constructor",c),c.displayName="GeneratorFunction",O(u,o,"GeneratorFunction"),O(d),O(d,o,"Generator"),O(d,r,function(){return this}),O(d,"toString",function(){return"[object Generator]"}),(A=function(){return{w:i,m:f}})()}function O(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}O=function(e,t,n,r){function i(t,n){O(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},O(e,t,n,r)}function L(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function j(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){L(i,r,o,a,s,"next",e)}function s(e){L(i,r,o,a,s,"throw",e)}a(void 0)})}}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,N(r.key),r)}}function N(e){var t=function(e,t){if("object"!=C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==C(t)?t:t+""}var D=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elementDiscovery=new k},t=[{key:"execute",value:(u=j(A().m(function e(t){var n,r;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t&&t.type){e.n=1;break}throw new Error("Invalid action: type is required");case 1:e.p=1,n=t.type,e.n="click"===n?2:"type"===n?4:"scroll"===n?6:"key"===n||"keypress"===n?8:"submit"===n?10:12;break;case 2:return e.n=3,this._executeClick(t);case 3:case 5:case 7:case 9:case 11:return e.a(2,e.v);case 4:return e.n=5,this._executeType(t);case 6:return e.n=7,this._executeScroll(t);case 8:return e.n=9,this._executeKeyPress(t);case 10:return e.n=11,this._executeSubmit(t);case 12:throw new Error("Unknown action type: ".concat(t.type));case 13:e.n=15;break;case 14:return e.p=14,r=e.v,e.a(2,{success:!1,error:r.message,action:t});case 15:return e.a(2)}},e,this,[[1,14]])})),function(e){return u.apply(this,arguments)})},{key:"_executeClick",value:(c=j(A().m(function e(t){var n;return A().w(function(e){for(;;)switch(e.n){case 0:if(n=this.elementDiscovery.findElementById(t.targetId)){e.n=1;break}throw new Error("Element not found: ".concat(t.targetId));case 1:return n.scrollIntoView({behavior:"smooth",block:"center"}),e.n=2,new Promise(function(e){return setTimeout(e,150)});case 2:return e.n=3,x(n);case 3:return e.n=4,this._waitForDOMChanges(250);case 4:return e.a(2,{success:!0,action:t,element:{id:t.targetId,tag:n.tagName.toLowerCase(),text:(n.textContent||"").trim().slice(0,50)}})}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"_executeType",value:(s=j(A().m(function e(t){var n,r,o,i,a,s,c,u;return A().w(function(e){for(;;)switch(e.n){case 0:if(n=this.elementDiscovery.findElementById(t.targetId)){e.n=1;break}throw new Error("Element not found: ".concat(t.targetId));case 1:if(t.value){e.n=2;break}throw new Error("Type action requires value");case 2:return n.scrollIntoView({behavior:"smooth",block:"center"}),e.n=3,new Promise(function(e){return setTimeout(e,150)});case 3:n.focus(),this._setReactValue(n,""),r=String(t.value),o=0;case 4:if(!(o<r.length)){e.n=6;break}return i=r[o],a=n.value+i,s=new KeyboardEvent("keydown",{bubbles:!0,key:i,code:"Key".concat(i.toUpperCase()),keyCode:i.charCodeAt(0),which:i.charCodeAt(0)}),n.dispatchEvent(s),this._setReactValue(n,a),c=new KeyboardEvent("keyup",{bubbles:!0,key:i,code:"Key".concat(i.toUpperCase()),keyCode:i.charCodeAt(0),which:i.charCodeAt(0)}),n.dispatchEvent(c),e.n=5,new Promise(function(e){return setTimeout(e,20)});case 5:o++,e.n=4;break;case 6:return u=new Event("change",{bubbles:!0}),n.dispatchEvent(u),e.n=7,this._waitForDOMChanges(150);case 7:return e.a(2,{success:!0,action:t,element:{id:t.targetId,tag:n.tagName.toLowerCase(),value:n.value}})}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"_setReactValue",value:function(e,t){var n,r,o=null===(n=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))||void 0===n?void 0:n.set,i=null===(r=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))||void 0===r?void 0:r.set;"INPUT"===e.tagName&&o?o.call(e,t):"TEXTAREA"===e.tagName&&i?i.call(e,t):e.value=t;var a=new Event("input",{bubbles:!0});e.dispatchEvent(a)}},{key:"_waitForDOMChanges",value:(a=j(A().m(function e(){var t,n=arguments;return A().w(function(e){for(;;)if(0===e.n)return t=n.length>0&&void 0!==n[0]?n[0]:250,e.a(2,new Promise(function(e){var n,r=new MutationObserver(function(t){n&&clearTimeout(n),n=setTimeout(function(){r.disconnect(),e()},100)});r.observe(document.body,{childList:!0,subtree:!0,attributes:!0}),setTimeout(function(){n&&clearTimeout(n),r.disconnect(),e()},t)}))},e)})),function(){return a.apply(this,arguments)})},{key:"_executeScroll",value:(i=j(A().m(function e(t){var n;return A().w(function(e){for(;;)switch(e.n){case 0:if(!t.targetId){e.n=2;break}if(!(n=this.elementDiscovery.findElementById(t.targetId))){e.n=2;break}return n.scrollIntoView({behavior:"smooth",block:"center"}),e.n=1,new Promise(function(e){return setTimeout(e,250)});case 1:return e.a(2,{success:!0,action:t,element:{id:t.targetId,tag:n.tagName.toLowerCase()}});case 2:return window.scrollBy({top:.8*window.innerHeight,behavior:"smooth"}),e.n=3,new Promise(function(e){return setTimeout(e,250)});case 3:return e.a(2,{success:!0,action:t})}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_executeKeyPress",value:(o=j(A().m(function e(t){var n,r,o,i,a;return A().w(function(e){for(;;)switch(e.n){case 0:if(n=this.elementDiscovery.findElementById(t.targetId)){e.n=1;break}throw new Error("Element not found: ".concat(t.targetId));case 1:return r=t.key||t.value||"Enter",n.scrollIntoView({behavior:"smooth",block:"center"}),e.n=2,new Promise(function(e){return setTimeout(e,300)});case 2:if(n.focus(),o=new KeyboardEvent("keydown",{key:r,code:"Enter"===r?"Enter":"Key".concat(r),keyCode:"Enter"===r?13:r.charCodeAt(0),which:"Enter"===r?13:r.charCodeAt(0),bubbles:!0,cancelable:!0}),i=new KeyboardEvent("keypress",{key:r,code:"Enter"===r?"Enter":"Key".concat(r),keyCode:"Enter"===r?13:r.charCodeAt(0),which:"Enter"===r?13:r.charCodeAt(0),bubbles:!0,cancelable:!0}),a=new KeyboardEvent("keyup",{key:r,code:"Enter"===r?"Enter":"Key".concat(r),keyCode:"Enter"===r?13:r.charCodeAt(0),which:"Enter"===r?13:r.charCodeAt(0),bubbles:!0,cancelable:!0}),n.dispatchEvent(o),n.dispatchEvent(i),n.dispatchEvent(a),"Enter"!==r||"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName){e.n=3;break}return e.n=3,new Promise(function(e){return setTimeout(e,50)});case 3:return e.n=4,this._waitForDOMChanges(150);case 4:return e.a(2,{success:!0,action:t,element:{id:t.targetId,tag:n.tagName.toLowerCase(),key:r}})}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"_executeSubmit",value:(r=j(A().m(function e(t){var n,r,o;return A().w(function(e){for(;;)switch(e.n){case 0:if(n=this.elementDiscovery.findElementById(t.targetId)){e.n=1;break}throw new Error("Element not found: ".concat(t.targetId));case 1:if(r=n,"FORM"!==n.tagName&&(r=n.closest("form")),r){e.n=2;break}throw new Error("No form found for element");case 2:return r.scrollIntoView({behavior:"smooth",block:"center"}),e.n=3,new Promise(function(e){return setTimeout(e,300)});case 3:o=new Event("submit",{bubbles:!0,cancelable:!0}),r.dispatchEvent(o);try{r.submit()}catch(e){}return e.a(2,{success:!0,action:t,element:{id:t.targetId,tag:r.tagName.toLowerCase()}})}},e,this)})),function(e){return r.apply(this,arguments)})}],t&&P(e.prototype,t),n&&P(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,a,s,c,u}();function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function B(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return M(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(M(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,M(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,M(d,"constructor",u),M(u,"constructor",c),c.displayName="GeneratorFunction",M(u,o,"GeneratorFunction"),M(d),M(d,o,"Generator"),M(d,r,function(){return this}),M(d,"toString",function(){return"[object Generator]"}),(B=function(){return{w:i,m:f}})()}function M(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}M=function(e,t,n,r){function i(t,n){M(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},M(e,t,n,r)}function R(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Y(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){R(i,r,o,a,s,"next",e)}function s(e){R(i,r,o,a,s,"throw",e)}a(void 0)})}}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,W(r.key),r)}}function W(e){var t=function(e,t){if("object"!=F(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==F(t)?t:t+""}var K=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isVisible=!1},t=[{key:"showAction",value:(o=Y(B().m(function e(t){return B().w(function(e){for(;;)if(0===e.n)return this.isVisible||(T(),this.isVisible=!0),e.a(2,Promise.resolve())},e,this)})),function(e){return o.apply(this,arguments)})},{key:"guideAction",value:(r=Y(B().m(function e(t){return B().w(function(e){for(;;)if(0===e.n)return this.isVisible||(T(),this.isVisible=!0),t.targetId&&this._highlightElement(t.targetId),e.a(2,Promise.resolve())},e,this)})),function(e){return r.apply(this,arguments)})},{key:"hide",value:function(){this.isVisible&&(I&&I.hide_cursor&&I.hide_cursor(),this.isVisible=!1),this._removeHighlights()}},{key:"_highlightElement",value:function(e){this._removeHighlights();var t=document.querySelector('[data-weblayer-id="'.concat(e,'"]'));if(t){if(t.classList.add("weblayer-acb-highlight"),!document.getElementById("weblayer-acb-styles")){var n=document.createElement("style");n.id="weblayer-acb-styles",n.textContent="\n                .weblayer-acb-highlight {\n                    outline: 3px solid #3b82f6 !important;\n                    outline-offset: 2px !important;\n                    box-shadow: 0 0 10px rgba(59, 130, 246, 0.5) !important;\n                    transition: outline 0.2s ease !important;\n                }\n            ",document.head.appendChild(n)}setTimeout(function(){t.classList.remove("weblayer-acb-highlight")},2e3)}}},{key:"_removeHighlights",value:function(){document.querySelectorAll(".weblayer-acb-highlight").forEach(function(e){e.classList.remove("weblayer-acb-highlight")})}}],t&&X(e.prototype,t),n&&X(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o}();function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function q(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return U(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(U(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,U(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,U(d,"constructor",u),U(u,"constructor",c),c.displayName="GeneratorFunction",U(u,o,"GeneratorFunction"),U(d),U(d,o,"Generator"),U(d,r,function(){return this}),U(d,"toString",function(){return"[object Generator]"}),(q=function(){return{w:i,m:f}})()}function U(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}U=function(e,t,n,r){function i(t,n){U(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},U(e,t,n,r)}function H(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function V(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){H(i,r,o,a,s,"next",e)}function s(e){H(i,r,o,a,s,"throw",e)}a(void 0)})}}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,J(r.key),r)}}function J(e){var t=function(e,t){if("object"!=G(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==G(t)?t:t+""}var $=function(){return t=function t(n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.apiUrl=n||e.apiUrl||"https://api.weblayer.ai",this.orgId=r||e.org_id},n=[{key:"_getApiKey",value:function(){return null}},{key:"_request",value:(u=V(q().m(function e(t,n){var r,o,i,a;return q().w(function(e){for(;;)switch(e.p=e.n){case 0:return r="".concat(this.apiUrl).concat(t),e.p=1,e.n=2,fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this._getApiKey()||""},body:JSON.stringify(n)});case 2:if((o=e.v).ok){e.n=4;break}return e.n=3,o.json().catch(function(){return{error:o.statusText}});case 3:throw i=e.v,new Error(i.error||"HTTP ".concat(o.status));case 4:return e.n=5,o.json();case 5:return e.a(2,e.v);case 6:throw e.p=6,a=e.v,console.error("[ACB] API request failed (".concat(t,"):"),a),a;case 7:return e.a(2)}},e,this,[[1,6]])})),function(e,t){return u.apply(this,arguments)})},{key:"start",value:(c=V(q().m(function e(t){var n,r,o,i,a;return q().w(function(e){for(;;)switch(e.n){case 0:return n=t.prompt,r=t.mode,o=t.inventory,i=t.sessionId,a=t.visitorId,e.n=1,this._request("/sdk/acb/start",{prompt:n,mode:r,inventory:o,sessionId:i,visitorId:a,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"continue",value:(s=V(q().m(function e(t){var n,r,o;return q().w(function(e){for(;;)switch(e.n){case 0:return n=t.threadId,r=t.result,o=t.inventory,e.n=1,this._request("/sdk/acb/continue",{threadId:n,result:r,inventory:o,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"pause",value:(a=V(q().m(function e(t){return q().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._request("/sdk/acb/pause",{threadId:t,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"resume",value:(i=V(q().m(function e(t){var n,r;return q().w(function(e){for(;;)switch(e.n){case 0:return n=t.threadId,r=t.inventory,e.n=1,this._request("/sdk/acb/resume",{threadId:n,inventory:r,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"stop",value:(o=V(q().m(function e(t){return q().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._request("/sdk/acb/stop",{threadId:t,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return o.apply(this,arguments)})}],n&&z(t.prototype,n),r&&z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,i,a,s,c,u}();function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ee(r.key),r)}}function ee(e){var t=function(e,t){if("object"!=Q(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Q(t)?t:t+""}var te=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentSession=null},(t=[{key:"createSession",value:function(e,t){if(this.currentSession&&"active"===this.currentSession.status)throw new Error("Session already active");return this.currentSession={threadId:null,prompt:e,mode:t,status:"active",actionsExecuted:0,startTime:Date.now(),pausedAt:null},this.currentSession}},{key:"getCurrentSession",value:function(){return this.currentSession}},{key:"isRunning",value:function(){return this.currentSession&&"active"===this.currentSession.status}},{key:"isPaused",value:function(){return this.currentSession&&"paused"===this.currentSession.status}},{key:"pause",value:function(e){e||(e=this.currentSession),e&&"active"===e.status&&(e.status="paused",e.pausedAt=Date.now())}},{key:"resume",value:function(e){e||(e=this.currentSession),e&&"paused"===e.status&&(e.status="active",e.pausedAt=null)}},{key:"stop",value:function(e){e||(e=this.currentSession),e&&(e.status="stopped")}},{key:"complete",value:function(e){e||(e=this.currentSession),e&&(e.status="completed")}},{key:"error",value:function(e,t){e||(e=this.currentSession),e&&(e.status="error",e.error=t)}},{key:"clearSession",value:function(){this.currentSession=null}}])&&Z(e.prototype,t),n&&Z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return oe(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(oe(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,oe(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,oe(d,"constructor",u),oe(u,"constructor",c),c.displayName="GeneratorFunction",oe(u,o,"GeneratorFunction"),oe(d),oe(d,o,"Generator"),oe(d,r,function(){return this}),oe(d,"toString",function(){return"[object Generator]"}),(re=function(){return{w:i,m:f}})()}function oe(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}oe=function(e,t,n,r){function i(t,n){oe(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},oe(e,t,n,r)}function ie(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function ae(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){ie(i,r,o,a,s,"next",e)}function s(e){ie(i,r,o,a,s,"throw",e)}a(void 0)})}}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ce(r.key),r)}}function ce(e){var t=function(e,t){if("object"!=ne(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ne(t)?t:t+""}var ue=function(){return t=function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.config={apiUrl:n.apiUrl||e.apiUrl||"https://api.weblayer.ai",orgId:n.orgId||e.org_id,debug:n.debug||e.debug||!1},this.elementDiscovery=new k,this.actionExecutor=new D,this.visualFeedback=new K,this.llmClient=new $(this.config.apiUrl,this.config.orgId),this.stateManager=new te},n=[{key:"updateOrgId",value:function(e){this.config.orgId=e,this.llmClient=new $(this.config.apiUrl,e)}},{key:"acb",value:(c=ae(re().m(function e(t){var n,r,o,i,a,s,c,u=arguments;return re().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:"act",!this.stateManager.isRunning()){e.n=1;break}throw new Error("ACB already running. Stop or pause current session first.");case 1:if(t&&t.trim()){e.n=2;break}throw new Error("Prompt is required");case 2:if(["act","guide"].includes(n)){e.n=3;break}throw new Error('Mode must be "act" or "guide"');case 3:return this.config.debug&&console.log("[ACB] Starting ".concat(n," mode:"),t),r=this.stateManager.createSession(t,n),e.p=4,o=this.elementDiscovery.scan(),this.config.debug&&console.log("[ACB] Found ".concat(o.elements.length," interactive elements")),i=this._getSessionId(),a=this._getVisitorId(),e.n=5,this.llmClient.start({prompt:t,mode:n,inventory:o,sessionId:i,visitorId:a});case 5:return s=e.v,r.threadId=s.threadId,e.n=6,this._executionLoop(r,s.action,s.complete);case 6:return this.stateManager.complete(r),this.visualFeedback.hide(),e.a(2,{success:!0,threadId:r.threadId,status:"completed",actionsExecuted:r.actionsExecuted,duration:Date.now()-r.startTime});case 7:return e.p=7,c=e.v,this.stateManager.error(r,c),this.visualFeedback.hide(),e.a(2,{success:!1,threadId:r.threadId,status:"error",actionsExecuted:r.actionsExecuted,duration:Date.now()-r.startTime,error:c.message})}},e,this,[[4,7]])})),function(e){return c.apply(this,arguments)})},{key:"acbStop",value:(s=ae(re().m(function e(){var t,n;return re().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=this.stateManager.getCurrentSession()){e.n=1;break}return e.a(2,{success:!1,message:"No ACB session running"});case 1:return this.config.debug&&console.log("[ACB] Stopping session:",t.threadId),this.stateManager.stop(t),this.visualFeedback.hide(),e.p=2,e.n=3,this.llmClient.stop(t.threadId);case 3:e.n=5;break;case 4:e.p=4,n=e.v,this.config.debug&&console.warn("[ACB] Error notifying backend of stop:",n);case 5:return e.a(2,{success:!0,threadId:t.threadId,actionsExecuted:t.actionsExecuted,message:"Stopped by user"})}},e,this,[[2,4]])})),function(){return s.apply(this,arguments)})},{key:"acbPause",value:(a=ae(re().m(function e(){var t,n;return re().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=this.stateManager.getCurrentSession()){e.n=1;break}return e.a(2,{success:!1,message:"No ACB session running"});case 1:if("paused"!==t.status){e.n=2;break}return e.a(2,{success:!0,message:"Already paused"});case 2:return this.config.debug&&console.log("[ACB] Pausing session:",t.threadId),this.stateManager.pause(t),this.visualFeedback.hide(),e.p=3,e.n=4,this.llmClient.pause(t.threadId);case 4:e.n=6;break;case 5:e.p=5,n=e.v,this.config.debug&&console.warn("[ACB] Error notifying backend of pause:",n);case 6:return e.a(2,{success:!0,threadId:t.threadId,actionsExecuted:t.actionsExecuted,currentStep:t.actionsExecuted,message:"Paused"})}},e,this,[[3,5]])})),function(){return a.apply(this,arguments)})},{key:"acbResume",value:(i=ae(re().m(function e(){var t,n,r;return re().w(function(e){for(;;)switch(e.n){case 0:if(t=this.stateManager.getCurrentSession()){e.n=1;break}return e.a(2,{success:!1,message:"No paused ACB session"});case 1:if("paused"===t.status){e.n=2;break}return e.a(2,{success:!1,message:"ACB not paused"});case 2:return this.config.debug&&console.log("[ACB] Resuming session:",t.threadId),this.stateManager.resume(t),n=this.elementDiscovery.scan(),e.n=3,this.llmClient.resume({threadId:t.threadId,inventory:n});case 3:return r=e.v,e.n=4,this._executionLoop(t,r.action,r.complete);case 4:return e.a(2,{success:!0,threadId:t.threadId,message:"Resumed"})}},e,this)})),function(){return i.apply(this,arguments)})},{key:"getStatus",value:function(){var e=this.stateManager.getCurrentSession();return e?{running:!0,threadId:e.threadId,status:e.status,prompt:e.prompt,actionsExecuted:e.actionsExecuted,duration:Date.now()-e.startTime}:{running:!1}}},{key:"_executionLoop",value:(o=ae(re().m(function e(t,n){var r,o,i,a,s,c,u,l=arguments;return re().w(function(e){for(;;)switch(e.n){case 0:r=n,o=l.length>2&&void 0!==l[2]&&l[2];case 1:if(!r||o){e.n=13;break}if("stopped"!==t.status){e.n=2;break}return this.config.debug&&console.log("[ACB] Execution stopped"),e.a(3,13);case 2:if("paused"!==t.status){e.n=3;break}return this.config.debug&&console.log("[ACB] Execution paused"),e.a(3,13);case 3:if(!r.error){e.n=4;break}throw console.error("[ACB]  Action failed:",r.error),"claude_api_error"===r.error_type&&(console.error("[ACB] Error type: Claude API Error"),console.error("[ACB] Retryable:",r.retryable?"Yes":"No"),r.retry_attempts&&console.error("[ACB] Failed after ".concat(r.retry_attempts," retry attempts")),console.error("[ACB] This is likely a temporary issue with Claude's servers. Please try again in a moment.")),new Error("Action error: ".concat(r.error));case 4:if("act"!==t.mode){e.n=8;break}return e.n=5,this.visualFeedback.showAction(r);case 5:return e.n=6,this.actionExecutor.execute(r);case 6:return i=e.v,t.actionsExecuted++,i.success||this.config.debug&&console.warn("[ACB] Action failed:",i.error),a=this.elementDiscovery.scan(),e.n=7,this.llmClient.continue({threadId:t.threadId,result:{success:i.success,action:r,error:i.error,url:window.location.href},inventory:a});case 7:s=e.v,r=s.action,o=s.complete||!1,e.n=12;break;case 8:if("guide"!==t.mode){e.n=12;break}return e.n=9,this.visualFeedback.guideAction(r);case 9:return e.n=10,new Promise(function(e){return setTimeout(e,2e3)});case 10:return c=this.elementDiscovery.scan(),e.n=11,this.llmClient.continue({threadId:t.threadId,result:{guided:!0},inventory:c});case 11:u=e.v,r=u.action,o=u.complete||!1;case 12:e.n=1;break;case 13:this.visualFeedback.hide();case 14:return e.a(2)}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"_getSessionId",value:function(){return"undefined"!=typeof sessionStorage?sessionStorage.getItem("weblayer_session_id"):null}},{key:"_getVisitorId",value:function(){return this._getCookie("weblayer_visitor_id")}},{key:"_getCookie",value:function(e){if("undefined"==typeof document)return null;var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?t[2]:null}}],n&&se(t.prototype,n),r&&se(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,i,a,s,c}();function le(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return de(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(de(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,de(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,de(d,"constructor",u),de(u,"constructor",c),c.displayName="GeneratorFunction",de(u,o,"GeneratorFunction"),de(d),de(d,o,"Generator"),de(d,r,function(){return this}),de(d,"toString",function(){return"[object Generator]"}),(le=function(){return{w:i,m:f}})()}function de(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}de=function(e,t,n,r){function i(t,n){de(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},de(e,t,n,r)}function fe(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function pe(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){fe(i,r,o,a,s,"next",e)}function s(e){fe(i,r,o,a,s,"throw",e)}a(void 0)})}}function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,me(r.key),r)}}function me(e){var t=function(e,t){if("object"!=ve(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ve(t)?t:t+""}var ye=null;function ge(){if(!ye)try{ye=new ue({apiUrl:e.apiUrl||"https://api.weblayer.ai",orgId:e.org_id,debug:e.debug||!1})}catch(e){console.error("[weblayer] Failed to initialize ACB controller:",e)}return ye}var we=function(){return t=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},o=[{key:"act",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"act";if("undefined"!=typeof window&&window.WEBLAYERSDK&&window.WEBLAYERSDK.acb)return window.WEBLAYERSDK.acb(e,t);throw new Error("WEBLAYERSDK not available. Make sure the SDK is loaded and WebLayerSDK.init() has been called.")}},{key:"init",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!t)return void console.error("[weblayer] orgId is required");e.org_id=t,e.apiUrl=r.apiUrl||e.apiUrl||"https://api.weblayer.ai",e.debug=r.debug||!1,e.weblayerEnabled=!1!==r.weblayerEnabled,console.log("[weblayer] WebLayer SDK initialized with org_id: ",t,"yes"),e.debug&&console.log("[weblayer] API URL:",e.apiUrl);var o=n();if(!o)return void console.error("[weblayer] Failed to create visitor ID");e.debug&&console.log("[weblayer] Visitor ID:",o);try{g(o)}catch(e){console.error("[weblayer] Failed to initialize tracking:",e)}if("undefined"!=typeof window)try{ye?(ye.updateOrgId(e.org_id),ye.config.apiUrl=e.apiUrl,ye.config.debug=e.debug):ge(),e.debug&&console.log("[weblayer] ACB module updated with orgId:",e.org_id)}catch(e){console.error("[weblayer] Failed to update ACB controller:",e)}return!0}catch(t){return e.debug&&console.error("[weblayer] Error initializing WebLayer SDK:",t),!1}}}],(r=null)&&he(t.prototype,r),o&&he(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,o}();function be(){if(!window._weblayerInitialized){window._weblayerInitialized=!0;var t=document.querySelector("script#weblayer-sdk");if(t){var n=t.getAttribute("data-org-id");if(!n&&t.src)try{var r=new URL(t.src),o=r.pathname.split("/").filter(function(e){return e.length>0});o.length>0&&r.hostname.includes("sdk.weblayer.ai")&&(n=o[o.length-1])}catch(e){var i=t.src||"";if(i.includes("sdk.weblayer.ai/")){var a=i.match(/sdk\.weblayer\.ai\/([^\/\?#]+)/);a&&a[1]&&(n=a[1])}}var s="true"===t.getAttribute("data-debug")?{debug:!0}:{};if(n)try{we.init(n,s)}catch(t){e.debug&&console.error("[weblayer] Failed to initialize WebLayer SDK:",t)}else e.debug&&console.warn("[weblayer] WebLayer SDK script tag found but no org_id detected. Call WebLayerSDK.init(orgId) manually.")}else e.debug&&console.warn('[weblayer] WebLayer SDK script tag not found or missing id="weblayer-sdk"')}}"undefined"!=typeof window&&(window.WebLayerSDK=we,window.WEBLAYERSDK=window.WEBLAYERSDK||{},window.WEBLAYERSDK.acb=function(){var e=pe(le().m(function e(t){var n,r,o=arguments;return le().w(function(e){for(;;)switch(e.n){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:"act",r=ge()){e.n=1;break}throw new Error("ACB not available. Make sure WebLayerSDK.init() has been called with an orgId.");case 1:return e.n=2,r.acb(t,n);case 2:return e.a(2,e.v)}},e)}));return function(t){return e.apply(this,arguments)}}(),window.WEBLAYERSDK.acbStop=pe(le().m(function e(){var t;return le().w(function(e){for(;;)switch(e.n){case 0:if(t=ge()){e.n=1;break}throw new Error("ACB not available. Make sure WebLayerSDK.init() has been called with an orgId.");case 1:return e.n=2,t.acbStop();case 2:return e.a(2,e.v)}},e)})),window.WEBLAYERSDK.acbPause=pe(le().m(function e(){var t;return le().w(function(e){for(;;)switch(e.n){case 0:if(t=ge()){e.n=1;break}throw new Error("ACB not available. Make sure WebLayerSDK.init() has been called with an orgId.");case 1:return e.n=2,t.acbPause();case 2:return e.a(2,e.v)}},e)})),window.WEBLAYERSDK.acbResume=pe(le().m(function e(){var t;return le().w(function(e){for(;;)switch(e.n){case 0:if(t=ge()){e.n=1;break}throw new Error("ACB not available. Make sure WebLayerSDK.init() has been called with an orgId.");case 1:return e.n=2,t.acbResume();case 2:return e.a(2,e.v)}},e)})),window.WEBLAYERSDK.acbStatus=function(){var e=ge();return e?e.getStatus():{running:!1,error:"ACB not available"}},we.act=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"act";if(window.WEBLAYERSDK&&window.WEBLAYERSDK.acb)return window.WEBLAYERSDK.acb(e,t);throw new Error("WEBLAYERSDK not available. Make sure the SDK is loaded and WebLayerSDK.init() has been called.")},window.act=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"act";return we.act(e,t)}),document.addEventListener("DOMContentLoaded",function(){be()}),window.addEventListener("load",function(){be()});setTimeout(function(){be()},5e3)})();