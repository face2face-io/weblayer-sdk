/*! For license information please see weblayer-sdk.min.js.LICENSE.txt */
(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>Se});const n={apiUrl:"https://api.weblayer.ai",debug:!1,org_id:null,weblayerEnabled:!0};function r(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:365,i=(n=window.location.hostname,(r=n.split(".")).length<=1?n:"."+r.slice(-2).join(".")),a=new Date;a.setTime(a.getTime()+24*o*60*60*1e3);var s="".concat(e,"=").concat(t,"; expires=").concat(a.toUTCString(),"; domain=").concat(i,"; path=/; SameSite=Lax");document.cookie=s}function o(){var e,t,n="weblayer_visitor_id",o="weblayer_visitor_id",i=(e=n,2===(t="; ".concat(document.cookie).split("; ".concat(e,"="))).length?t.pop().split(";").shift():null);if(i){try{localStorage.setItem(o,i)}catch(e){}return i}try{if(i=localStorage.getItem(o))return r(n,i),i}catch(e){}i="".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2,15));try{r(n,i),localStorage.setItem(o,i)}catch(e){}return i}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof u?r:u,l=Object.create(s.prototype);return c(l,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),l}var a={};function u(){}function l(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(c(t={},r,function(){return this}),t),p=d.prototype=u.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,c(p,"constructor",d),c(d,"constructor",l),l.displayName="GeneratorFunction",c(d,o,"GeneratorFunction"),c(p),c(p,o,"Generator"),c(p,r,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:i,m:v}})()}function c(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}c=function(e,t,n,r){function i(t,n){c(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},c(e,t,n,r)}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)})}}var f=[],p=null;function v(e){f.push(e);var t=JSON.stringify(f).length;f.length>=50||t>=65536?h():p||(p=setTimeout(h,5e3))}var m=window.fetch;function h(){return y.apply(this,arguments)}function y(){return(y=d(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(f.length){e.n=1;break}return e.a(2);case 1:return t=f,f=[],clearTimeout(p),p=null,e.p=2,e.n=3,m("".concat(n.apiUrl,"/sdk/events"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:t})});case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function g(){return(new Date).toISOString()}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;return e?String(e).replace(/\s+/g," ").slice(0,t):null}function b(e){if(n.weblayerEnabled&&e&&n.org_id){var t=sessionStorage.getItem("weblayer_session_id");t||(t="".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2)),sessionStorage.setItem("weblayer_session_id",t)),v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:t,page_url:window.location.href,referrer:document.referrer||null,event_type:"navigation",event_name:"load",event_data:{title:document.title}}),window.addEventListener("error",function(r){var o=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"error",event_name:"window.onerror",event_data:{message:r.message,filename:r.filename,lineno:r.lineno,colno:r.colno}})}),window.addEventListener("unhandledrejection",function(r){var o=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"error",event_name:"unhandledrejection",event_data:{message:w(r.reason&&(r.reason.message||String(r.reason)))}})}),document.addEventListener("invalid",function(r){var o=sessionStorage.getItem("weblayer_session_id")||t,i=r.target;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"validation_error",event_name:"invalid",event_data:{element:i.tagName.toLowerCase(),type:i.type||null,name:i.name||null,id:i.id||null,validation_message:i.validationMessage||null,value_length:(i.value||"").length}})},!0);var r=new WeakMap,o=new WeakMap;document.addEventListener("focus",function(e){return X("focus",e)},!0),document.addEventListener("blur",function(e){return X("blur",e)},!0),document.addEventListener("input",function(e){return X("input",e)},!0),document.addEventListener("change",function(e){return X("change",e)},!0),document.addEventListener("submit",function(o){try{var i=o.target;if(!i||"FORM"!==i.tagName)return;var a=sessionStorage.getItem("weblayer_session_id")||t,s=r.get(i),c=s?Date.now()-s:null,u=i.querySelectorAll("input, textarea, select").length;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:a,page_url:window.location.href,referrer:document.referrer||null,event_type:"form_interaction",event_name:"submit",event_data:{form_id:i.id||null,field_count:u,completion_time_ms:c}}),r.delete(i)}catch(o){n.debug&&console.warn("[weblayer] Failed to track form submit:",o)}},!0),document.addEventListener("focus",function(e){try{var t=e.target;if(!t||!t.tagName)return;var n=t.tagName.toLowerCase();if(!["input","textarea","select"].includes(n))return;var o=t.closest("form");o&&!r.has(o)&&r.set(o,Date.now())}catch(e){}},!0),document.addEventListener("focusin",function(r){try{var o=r.target,i=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"focus",event_name:"focusin",event_data:{target_tag:o&&o.tagName?o.tagName.toLowerCase():null,target_id:o&&o.id||null,target_classes:o&&o.className||null}})}catch(r){n.debug&&console.warn("[weblayer] Failed to track focusin:",r)}},!0),document.addEventListener("focusout",function(r){try{var o=r.target,i=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"focus",event_name:"focusout",event_data:{target_tag:o&&o.tagName?o.tagName.toLowerCase():null,target_id:o&&o.id||null,target_classes:o&&o.className||null}})}catch(r){n.debug&&console.warn("[weblayer] Failed to track focusout:",r)}},!0);var a=console.error,c=console.warn;console.error=function(){try{var r=sessionStorage.getItem("weblayer_session_id")||t,o=Array.from(arguments).map(function(e){return"object"===u(e)?JSON.stringify(e):String(e)}).join(" ");v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"console",event_name:"error",event_data:{message:w(o,500)}})}catch(e){}return a.apply(console,arguments)},console.warn=function(){try{var r=sessionStorage.getItem("weblayer_session_id")||t,o=Array.from(arguments).map(function(e){return"object"===u(e)?JSON.stringify(e):String(e)}).join(" ");v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"console",event_name:"warn",event_data:{message:w(o,500)}})}catch(e){}return c.apply(console,arguments)};var l=window.fetch;l.__weblayerWrapped||(window.fetch=function(){var r=d(s().m(function r(o,i){var a,c,u,d,f,p,m,h,y,b=arguments;return s().w(function(r){for(;;)switch(r.p=r.n){case 0:if(!b[0]||"string"!=typeof b[0]||!b[0].includes("/sdk/events")){r.n=1;break}return r.a(2,l.apply(this,b));case 1:return a=performance.now(),c="string"==typeof o?o:o instanceof Request?o.url:String(o),u=i&&i.method||o instanceof Request&&o.method||"GET",r.p=2,r.n=3,l.apply(this,b);case 3:d=r.v,f=Math.round(performance.now()-a),p=sessionStorage.getItem("weblayer_session_id")||t;try{v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:p,page_url:window.location.href,referrer:document.referrer||null,event_type:"network",event_name:u,event_data:{url:c,method:u},status:d.status,duration_ms:f})}catch(e){n.debug&&console.warn("[weblayer] Failed to track fetch:",e)}return r.a(2,d);case 4:r.p=4,y=r.v,m=Math.round(performance.now()-a),h=sessionStorage.getItem("weblayer_session_id")||t;try{v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:h,page_url:window.location.href,referrer:document.referrer||null,event_type:"network",event_name:u,event_data:{url:c,method:u,error:w(y&&y.message)},status:0,duration_ms:m})}catch(e){n.debug&&console.warn("[weblayer] Failed to track fetch error:",e)}throw y;case 5:return r.a(2)}},r,this,[[2,4]])}));return function(e,t){return r.apply(this,arguments)}}(),window.fetch.__weblayerWrapped=!0,window.fetch.toString=function(){return l.toString()});var p=XMLHttpRequest.prototype.open,m=XMLHttpRequest.prototype.send;p.__weblayerWrapped||(XMLHttpRequest.prototype.open=function(e,t){return this._weblayerMethod=e,this._weblayerUrl=t,this._weblayerSkip="string"==typeof t&&t.includes("/sdk/events"),p.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){if(this._weblayerSkip)return m.apply(this,arguments);var r=performance.now(),o=this._weblayerMethod||"GET",i=this._weblayerUrl||"";return this.addEventListener("loadend",function(){try{var a=Math.round(performance.now()-r),s=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:s,page_url:window.location.href,referrer:document.referrer||null,event_type:"network",event_name:o,event_data:{url:i,method:o},status:this.status||0,duration_ms:a})}catch(e){n.debug&&console.warn("[weblayer] Failed to track XHR:",e)}}),m.apply(this,arguments)},XMLHttpRequest.prototype.open.__weblayerWrapped=!0,XMLHttpRequest.prototype.send.__weblayerWrapped=!0);var y=new WeakSet;if(function(){try{var e=document.querySelectorAll("video"),t=document.querySelectorAll("audio");e.forEach(function(e){return Y(e)}),t.forEach(function(e){return Y(e)})}catch(e){n.debug&&console.warn("[weblayer] Failed to track existing media:",e)}}(),"undefined"!=typeof MutationObserver){var b=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){if(1===e.nodeType){"VIDEO"!==e.tagName&&"AUDIO"!==e.tagName||Y(e);var t=e.querySelectorAll?e.querySelectorAll("video"):[],n=e.querySelectorAll?e.querySelectorAll("audio"):[];t.forEach(function(e){return Y(e)}),n.forEach(function(e){return Y(e)})}})})});try{b.observe(document.body,{childList:!0,subtree:!0})}catch(e){n.debug&&console.warn("[weblayer] Failed to set up media observer:",e)}}document.addEventListener("click",function(r){var o=r.target;if(o&&o.tagName){var i=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"click",event_name:o.tagName.toLowerCase(),event_data:{id:o.id||null,classes:o.className||null,text:w(o.textContent)}});var a=window.location.href,s=f.length,c=Date.now(),u=!1,l=setInterval(function(){f.length>s&&(u=!0,clearInterval(l))},50),d=function(){u=!0};document.addEventListener("focusin",d,{once:!0,capture:!0});var p=function(){clearInterval(l),document.removeEventListener("focusin",d,!0)},m=function(){try{var e=document.body.innerText.slice(0,1e3),t=document.querySelectorAll('[role="dialog"], .modal, .popup').length,n=document.querySelectorAll('[class*="loading"], [class*="spinner"], [class*="Loading"], [class*="Spinner"], [aria-busy="true"], [data-loading="true"], svg[class*="spin"], svg[class*="rotate"]').length,r=document.querySelectorAll("button:disabled, input:disabled").length,i="";try{if(!o||!o.isConnected)return"element-removed";i="".concat(o.className,"-").concat(o.disabled,"-").concat(o.getAttribute("aria-busy"))}catch(e){return"element-removed"}return"".concat(e.length,"-").concat(t,"-").concat(n,"-").concat(r,"-").concat(i)}catch(e){return"error"}},h=m(),y=function(r){try{var i=window.location.href!==a,s=m();if(i||h!==s||u)return void p();if(2===r){p();var l=window.getComputedStyle(o),d=!(!o.onclick&&!o.getAttribute("onclick")),f=l.cursor,y=["A","BUTTON","INPUT","SELECT","TEXTAREA"].includes(o.tagName),b="LABEL"===o.tagName&&o.htmlFor,_="A"===o.tagName&&o.href&&"#"!==o.href&&!o.href.startsWith("javascript:"),S=["INPUT","SELECT","TEXTAREA"].includes(o.tagName);if(y&&!b&&!S||d&&!_||"pointer"===f&&!b){var E=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:E,page_url:window.location.href,referrer:document.referrer||null,event_type:"dead_click",event_name:"no_response",event_data:{element:{tag:o.tagName.toLowerCase(),id:o.id||null,classes:o.className||null,text:w(o.textContent),href:o.href||null},context:{expected_interactive:y,has_click_handler:d,cursor_style:f,time_since_click:Date.now()-c}}})}}}catch(e){n.debug&&console.warn("[weblayer] Dead-click detection failed:",e)}};setTimeout(function(){return y(1)},500),setTimeout(function(){return y(2)},1500)}},{capture:!0});var _=new WeakMap,S=null;document.addEventListener("mouseenter",function(r){try{var o=r.target;if(!o||!o.tagName)return;var i=Date.now();_.set(o,i),clearTimeout(S),S=setTimeout(function(){var r=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"hover",event_name:"mouseenter",event_data:{target_tag:o.tagName.toLowerCase(),target_id:o.id||null,target_classes:o.className||null}})},100)}catch(r){n.debug&&console.warn("[weblayer] Failed to track mouseenter:",r)}},{capture:!0}),document.addEventListener("mouseleave",function(r){try{var o=r.target;if(!o||!o.tagName)return;var i=_.get(o),a=i?Date.now()-i:null,s=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:s,page_url:window.location.href,referrer:document.referrer||null,event_type:"hover",event_name:"mouseleave",event_data:{target_tag:o.tagName.toLowerCase(),target_id:o.id||null,target_classes:o.className||null,duration_ms:a}}),_.delete(o)}catch(r){n.debug&&console.warn("[weblayer] Failed to track mouseleave:",r)}},{capture:!0});var E=null;document.addEventListener("mouseover",function(r){try{var o=r.target;if(!o||!o.tagName)return;var i=o.tagName.toLowerCase();if(!(["a","button","input","select","textarea"].includes(i)||"button"===o.getAttribute("role")||null!==o.getAttribute("tabindex")))return;clearTimeout(E),E=setTimeout(function(){var r=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"hover",event_name:"hover",event_data:{target_tag:i,target_id:o.id||null,target_classes:o.className||null}})},100)}catch(r){n.debug&&console.warn("[weblayer] Failed to track mouseover:",r)}},{capture:!0});var k=null;document.addEventListener("touchstart",function(r){try{var o=sessionStorage.getItem("weblayer_session_id")||t,i=r.touches[0],a=r.target;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"touch",event_name:"touchstart",event_data:{x:i?i.clientX:null,y:i?i.clientY:null,target_id:a&&a.id||null,target_tag:a&&a.tagName?a.tagName.toLowerCase():null,target_classes:a&&a.className||null,touches_count:r.touches.length}})}catch(r){n.debug&&console.warn("[weblayer] Failed to track touchstart:",r)}},{capture:!0}),document.addEventListener("touchend",function(r){try{var o=sessionStorage.getItem("weblayer_session_id")||t,i=r.changedTouches[0],a=r.target;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"touch",event_name:"touchend",event_data:{x:i?i.clientX:null,y:i?i.clientY:null,target_id:a&&a.id||null,target_tag:a&&a.tagName?a.tagName.toLowerCase():null,target_classes:a&&a.className||null,touches_count:r.changedTouches.length}})}catch(r){n.debug&&console.warn("[weblayer] Failed to track touchend:",r)}},{capture:!0}),document.addEventListener("touchmove",function(r){try{clearTimeout(k),k=setTimeout(function(){var o=sessionStorage.getItem("weblayer_session_id")||t,i=r.touches[0],a=r.target;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"touch",event_name:"touchmove",event_data:{x:i?i.clientX:null,y:i?i.clientY:null,target_id:a&&a.id||null,target_tag:a&&a.tagName?a.tagName.toLowerCase():null,target_classes:a&&a.className||null,touches_count:r.touches.length}})},100)}catch(r){n.debug&&console.warn("[weblayer] Failed to track touchmove:",r)}},{capture:!0});var I=null,x=null,T=null,C=window.scrollX||0,O=window.scrollY||0,j=(Date.now(),null);window.addEventListener("scroll",function(){try{clearTimeout(I),clearTimeout(x),I=setTimeout(function(){var e=window.scrollX||window.pageXOffset||0,t=window.scrollY||window.pageYOffset||0,n=Date.now(),r=null;if(T){var o=t-O;Math.abs(o)>10&&(r=o>0?"down":"up")}T&&(Math.abs(t-O)>10||Math.abs(e-C)>10)&&G(),C=e,O=t,x=setTimeout(function(){var e=window.scrollX||window.pageXOffset||0,t=window.scrollY||window.pageYOffset||0;R(e,t,r||(t>(O||0)?"down":t<(O||0)?"up":null))},600)},150)}catch(e){n.debug&&console.warn("[weblayer] Failed to track scroll:",e)}},{passive:!0}),window.addEventListener("beforeunload",function(){G()}),document.addEventListener("visibilitychange",function(){document.hidden&&G()});var A=null;document.addEventListener("selectstart",function(r){try{var o=r.target,i=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"selection",event_name:"selectstart",event_data:{target_tag:o&&o.tagName?o.tagName.toLowerCase():null}})}catch(r){n.debug&&console.warn("[weblayer] Failed to track selectstart:",r)}},{capture:!0}),document.addEventListener("selectionchange",function(){try{clearTimeout(A),A=setTimeout(function(){try{var r=window.getSelection();if(!r||0===r.rangeCount)return;var o=r.getRangeAt(0),i=o.toString();if(!i||0===i.trim().length)return;var a=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:a,page_url:window.location.href,referrer:document.referrer||null,event_type:"selection",event_name:"selectionchange",event_data:{text_snippet:w(i,200),text_length:i.length,target_tag:o.commonAncestorContainer&&1===o.commonAncestorContainer.nodeType&&o.commonAncestorContainer.tagName?o.commonAncestorContainer.tagName.toLowerCase():null}})}catch(e){}},200)}catch(e){n.debug&&console.warn("[weblayer] Failed to track selectionchange:",e)}}),document.addEventListener("copy",function(r){try{var o=window.getSelection();if(!o||0===o.rangeCount)return;var i=o.getRangeAt(0),a=i.toString();if(!a||0===a.trim().length)return;var s=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:s,page_url:window.location.href,referrer:document.referrer||null,event_type:"selection",event_name:"copy",event_data:{text_snippet:w(a,200),text_length:a.length,target_tag:i.commonAncestorContainer&&1===i.commonAncestorContainer.nodeType&&i.commonAncestorContainer.tagName?i.commonAncestorContainer.tagName.toLowerCase():null}})}catch(r){n.debug&&console.warn("[weblayer] Failed to track copy:",r)}},{capture:!0});var L=history.pushState,P=history.replaceState;history.pushState=function(){G(),L.apply(this,arguments);var r=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"navigation",event_name:"pushstate",event_data:{title:document.title,state:arguments[0]}})},history.replaceState=function(){G(),P.apply(this,arguments);var r=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"navigation",event_name:"replacestate",event_data:{title:document.title,state:arguments[0]}})},window.addEventListener("popstate",function(r){G();var o=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:o,page_url:window.location.href,referrer:document.referrer||null,event_type:"navigation",event_name:"popstate",event_data:{title:document.title,state:r.state}})});var N=null;window.addEventListener("resize",function(){try{clearTimeout(N),N=setTimeout(function(){var r=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"resize",event_name:"window_resize",event_data:{width:window.innerWidth,height:window.innerHeight}})},300)}catch(e){n.debug&&console.warn("[weblayer] Failed to track resize:",e)}}),window.addEventListener("beforeunload",function(){h()});Date.now();var F=0,D=0,M=Date.now(),B=null;document.addEventListener("visibilitychange",function(){try{q();var r=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"visibility",event_name:document.hidden?"hidden":"visible",event_data:{active_time_ms:F,inactive_time_ms:D}}),document.hidden?(h(),B&&(clearInterval(B),B=null)):(B&&clearInterval(B),B=setInterval(function(){try{q();var r=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"visibility",event_name:"active_time_update",event_data:{active_time_ms:F,inactive_time_ms:D}})}catch(e){n.debug&&console.warn("[weblayer] Failed to update visibility:",e)}},3e4))}catch(e){n.debug&&console.warn("[weblayer] Failed to track visibility:",e)}}),document.hidden||(M=Date.now(),B=setInterval(function(){try{q();var r=sessionStorage.getItem("weblayer_session_id")||t;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"visibility",event_name:"active_time_update",event_data:{active_time_ms:F,inactive_time_ms:D}})}catch(e){n.debug&&console.warn("[weblayer] Failed to update visibility:",e)}},3e4))}function X(r,i){try{var a=i.target;if(!a||!a.tagName)return;var s=a.tagName.toLowerCase();if(!["input","textarea","select"].includes(s))return;var c=sessionStorage.getItem("weblayer_session_id")||t,u={field_type:a.type||s,field_name:a.name||null,field_id:a.id||null,has_value:!!(a.value&&a.value.length>0),value_length:(a.value||"").length};"focus"===r&&o.set(a,Date.now()),v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:c,page_url:window.location.href,referrer:document.referrer||null,event_type:"form_interaction",event_name:r,event_data:u})}catch(i){n.debug&&console.warn("[weblayer] Failed to track form ".concat(r,":"),i)}}function Y(r){if(!y.has(r)&&(r.src||r.srcObject)){y.add(r);["play","pause","ended","seeking","timeupdate","volumechange","error"].forEach(function(o){r.addEventListener(o,function(r){try{var i=sessionStorage.getItem("weblayer_session_id")||t,a=r.target,s=a.src||(a.srcObject?"blob/object":null)||null;if(!s&&!a.srcObject)return;v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:i,page_url:window.location.href,referrer:document.referrer||null,event_type:"media",event_name:o,event_data:{element_type:a.tagName.toLowerCase(),src:w(s,200),current_time:a.currentTime||null,duration:a.duration||null,volume:void 0!==a.volume?a.volume:null,muted:void 0!==a.muted?a.muted:null,paused:void 0!==a.paused?a.paused:null}})}catch(r){n.debug&&console.warn("[weblayer] Failed to track media ".concat(o,":"),r)}})})}}function R(e,t,r){try{var o=Date.now(),a=(sessionStorage.getItem("weblayer_session_id"),function(){try{var e=window.scrollY||window.pageYOffset||0,t=e+window.innerHeight,r=window.scrollX||window.pageXOffset||0,o=r+window.innerWidth,a=[],s=[],c=[];if("undefined"!=typeof IntersectionObserver)document.querySelectorAll('h1, h2, h3, h4, h5, h6, p, img, [role="heading"]').forEach(function(n){try{var i=n.getBoundingClientRect(),u=e+i.top,l=u+i.height,d=r+i.left,f=d+i.width;if(l>e&&u<t&&f>r&&d<o&&i.width>0&&i.height>0){var p=n.tagName?n.tagName.toLowerCase():"";if(p.match(/^h[1-6]$/)||"heading"===n.getAttribute("role")){var v=w(n.textContent||n.innerText,200);v&&a.push({level:p,text:v})}else if("img"===p){var m=w(n.alt,100),h=w(n.src,200);c.push({alt:m||null,src:h||null})}else if("p"===p||n.textContent){var y=w(n.textContent||n.innerText,300);if(y&&!s.includes(y)&&(s.push(y),s.join(" ").length>=1e3))return}}}catch(e){}});else{var u=e+window.innerHeight/2,l=r+window.innerWidth/2;[[l,u],[l,e+.25*window.innerHeight],[l,e+.75*window.innerHeight]].forEach(function(t){var n=i(t,2),o=n[0],c=n[1];try{var u=document.elementFromPoint(o-r,c-e);if(u){var l=u.tagName?u.tagName.toLowerCase():"";if(l.match(/^h[1-6]$/)){var d=w(u.textContent,200);d&&a.push({level:l,text:d})}else if(u.textContent){var f=w(u.textContent,300);f&&!s.includes(f)&&s.push(f)}}}catch(e){}})}return{headings:a.slice(0,10),text_snippets:s.slice(0,5),images:c.slice(0,5)}}catch(e){return n.debug&&console.warn("[weblayer] Failed to capture visible content:",e),{headings:[],text_snippets:[],images:[]}}}()),s={scroll_x:e,scroll_y:t,viewport_width:window.innerWidth,viewport_height:window.innerHeight,visible_content:a,scroll_direction:r,stop_time:o};T=s,j&&(clearInterval(j),j=null),j=setInterval(function(){if(T&&T.stop_time){var e=Date.now()-T.stop_time;T.duration_ms=e}},2e3)}catch(e){n.debug&&console.warn("[weblayer] Failed to record scroll stop:",e)}}function G(){if(T)try{var r=sessionStorage.getItem("weblayer_session_id")||t,o=Date.now()-(T.stop_time||Date.now());v({ts:g(),org_id:n.org_id,visitor_id:e,session_id:r,page_url:window.location.href,referrer:document.referrer||null,event_type:"scroll",event_name:"scroll_stop",event_data:{scroll_x:T.scroll_x,scroll_y:T.scroll_y,viewport_width:T.viewport_width,viewport_height:T.viewport_height,visible_content:T.visible_content,scroll_direction:T.scroll_direction,duration_ms:o}}),T=null,j&&(clearInterval(j),j=null)}catch(e){n.debug&&console.warn("[weblayer] Failed to flush scroll stop:",e)}}function q(){var e=Date.now();document.hidden?D+=e-M:F+=e-M,M=e}}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function S(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return E(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function I(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}var x=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elementCounter=0},t=[{key:"scan",value:function(){var e=this;this.elementCounter=0;var t=[],n=new Set;return["button","a[href]",'input[type="button"]','input[type="submit"]','input[type="reset"]','input[type="checkbox"]','input[type="radio"]','input[type="text"]','input[type="email"]','input[type="password"]','input[type="search"]','input[type="tel"]','input[type="url"]','input[type="number"]',"textarea","select",'[role="button"]','[role="link"]','[role="checkbox"]','[role="radio"]','[role="textbox"]','[role="combobox"]','[role="option"]',"[onclick]",'[tabindex]:not([tabindex="-1"])'].forEach(function(t){try{document.querySelectorAll(t).forEach(function(t){e._isElementVisible(t)&&n.add(t)})}catch(e){}}),n.forEach(function(n){var r=e._extractElementData(n);r&&t.push(r)}),{elements:t,timestamp:Date.now(),url:window.location.href}}},{key:"_extractElementData",value:function(e){try{if(!this._isElementVisible(e))return null;var t=e.getBoundingClientRect(),n=t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth),r="";try{r=(r=e.textContent||e.innerText||"").replace(/\s+/g," ").trim().slice(0,100)}catch(e){}var o=e.tagName.toLowerCase(),i=e.id||null,a=e.className?String(e.className).split(/\s+/).filter(function(e){return e}).join(" "):null,s=e.type||null,c=e.href||null,u=e.placeholder||null,l=e.getAttribute("aria-label")||null,d=e.getAttribute("role")||null,f="wl-".concat(++this.elementCounter);return e.dataset.weblayerId||(e.dataset.weblayerId=f),{id:e.dataset.weblayerId||f,tag:o,text:r,id_attr:i,classes:a,type:s,href:c,placeholder:u,ariaLabel:l,role:d,visible:n,position:{top:Math.round(t.top),left:Math.round(t.left),width:Math.round(t.width),height:Math.round(t.height)}}}catch(e){return console.warn("[ACB] Error extracting element data:",e),null}}},{key:"_isElementVisible",value:function(e){try{if(!e||!e.offsetParent)return!1;var t=window.getComputedStyle(e);if("none"===t.display||"hidden"===t.visibility||"0"===t.opacity)return!1;var n=e.getBoundingClientRect();return 0!==n.width||0!==n.height}catch(e){return!1}}},{key:"findElementById",value:function(e){var t=document.querySelector('[data-weblayer-id="'.concat(e,'"]'));if(t)return t;var n=this.scan().elements.find(function(t){return t.id===e});if(n){if(n.id_attr){var r=document.getElementById(n.id_attr);if(r)return r}if(n.text){var o,i=S(document.querySelectorAll(n.tag));try{for(i.s();!(o=i.n()).done;){var a=o.value;if((a.textContent||"").trim()===n.text&&this._isElementVisible(a))return a}}catch(e){i.e(e)}finally{i.f()}}}return null}}],t&&k(e.prototype,t),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();const T=function(){var e={x:1,y:1},t=[],n=230*Math.random()+20,r=!0,o=null,i=null;function a(){o||((o=document.createElement("div")).id="virtualpointer-cursor",o.style.cssText="position: fixed;width: 20px;height: 20px;border-radius: 50%;background: rgba(255, 0, 0, 0.6);border: 2px solid rgba(255, 255, 255, 0.9);pointer-events: none;z-index: 999999;transition: all 0.1s ease-out;box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);transform: translate(-50%, -50%);",(i=document.createElement("div")).id="virtualpointer-ripple",i.style.cssText="position: fixed;width: 10px;height: 10px;border-radius: 50%;background: rgba(255, 0, 0, 0.4);border: 2px solid rgba(255, 0, 0, 0.6);pointer-events: none;z-index: 999998;transform: translate(-50%, -50%) scale(0);opacity: 0;",document.body.appendChild(o),document.body.appendChild(i))}function s(t,n,a,s,c,u,l,d,f,p){if("scroll"!=t){u||(u=n+1),l||(l=a+30),function(e,t,n){if(r&&o)if(n){var i=n.getBoundingClientRect(),a=i.left+i.width/2,s=i.top+i.height/2;o.style.left=a+"px",o.style.top=s+"px"}else{var c=e-(window.pageXOffset||document.documentElement.scrollLeft),u=t-(window.pageYOffset||document.documentElement.scrollTop);o.style.left=c+"px",o.style.top=u+"px"}}(n,a,s),"click"!==t&&"mousedown"!==t&&"touchstart"!==t||function(e,t,n){if(r&&i){if(n){var o=n.getBoundingClientRect(),a=o.left+o.width/2,s=o.top+o.height/2;i.style.left=a+"px",i.style.top=s+"px"}else{var c=e-(window.pageXOffset||document.documentElement.scrollLeft),u=t-(window.pageYOffset||document.documentElement.scrollTop);i.style.left=c+"px",i.style.top=u+"px"}i.style.transition="none",i.style.transform="translate(-50%, -50%) scale(0)",i.style.opacity="1",i.offsetHeight,i.style.transition="all 0.4s ease-out",i.style.transform="translate(-50%, -50%) scale(4)",i.style.opacity="0"}}(n,a,s),c||"click"!==t&&"mousedown"!==t&&"mouseup"!==t||(c=0);var v,m="mousemove"!==t&&"touchmove"!==t?1:0;if(d&&("ontouchstart"in window||navigator.msMaxTouchPoints>0))(v=document.createEvent("TouchEvent")).initTouchEvent(t,!0,!0,window,m,u,l,n,a,!1,!1,!1,!1,c,null);else(v=document.createEvent("MouseEvent")).initMouseEvent(t,!0,!0,window,m,u,l,n,a,!1,!1,!1,!1,c,null);s?s.dispatchEvent(v):document.body.dispatchEvent(v),e={x:u,y:l}}else window.scrollTo(f,p)}function c(){if(t.length){var e=t[0],n=t[1];if(s(e.type,e.pageX,e.pageY,e.target,null,e.screenX,e.screenY,e.isTouchEvent,e.scrollLeft,e.scrollTop),n){var r=n.timestamp-e.timestamp;setTimeout(c,r)}t.shift()}}function u(e){var t=document.body.getBoundingClientRect(),n=e.getBoundingClientRect(),r=n.top-t.top;return{x:n.left-t.left,y:r}}function l(e,t){if(function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(e))t&&t();else{e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});var n=window.pageYOffset||document.documentElement.scrollTop,r=window.pageXOffset||document.documentElement.scrollLeft,o=function(){var e=window.pageYOffset||document.documentElement.scrollTop,i=window.pageXOffset||document.documentElement.scrollLeft;e===n&&i===r?t&&t():(n=e,r=i,setTimeout(o,50))};setTimeout(o,100)}}function d(n,r){for(var o=u(n),i=o.x-e.x,a=o.y-e.y,s=r/20,c=1;c<=s;c++){var l=Math.round(i/s*c)+e.x,d=Math.round(a/s*c)+e.y;t.push({type:"mousemove",pageX:l,pageY:d,screenX:l+1,screenY:d+30,timestamp:20*c})}}function f(e,r,o){var i,a,s=u(e),c=t.length?t[t.length-1].timestamp:0;r||(r=n),o?(i=s.x,a=s.y,t.push({type:"touchstart",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c,target:e,isTouchEvent:!0}),t.push({type:"touchmove",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+Math.floor(n/2),target:e,isTouchEvent:!0}),t.push({type:"touchend",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+n,target:e,isTouchEvent:!0})):(i=s.x+1,a=s.y+30,t.push({type:"mouseover",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+n+10,target:e,isTouchEvent:!1}),t.push({type:"mousemove",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+n+20,target:e,isTouchEvent:!1}),t.push({type:"mousedown",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+n+20,target:e,isTouchEvent:!1}),t.push({type:"mouseup",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+2*n,target:e,isTouchEvent:!1}),t.push({type:"click",pageX:s.x,pageY:s.y,screenX:i,screenY:a,timestamp:c+2*n+10,target:e,isTouchEvent:!1}))}function p(){r&&a(),setTimeout(c,50)}return{move_mouse_to_element:function(e,t){e&&l(e,function(){d(e,t),p()})},click_element:function(e){e&&l(e,function(){f(e),p()})},move_to_element_and_click:function(e,t){e&&l(e,function(){d(e,t),f(e),p()})},tap_element:function(e){e&&l(e,function(){f(e,null,!0),p()})},double_tap_element:function(e){e&&l(e,function(){f(e,null,!0),f(e,25,!0),p()})},flick_to_element:function(e,t){e&&l(e,function(){f(e,t,!0),p()})},run_serialized_events:function(e){e&&e instanceof Array&&(t=e,p())},show_cursor:function(){r=!0,a()},hide_cursor:function(){r=!1,o&&o.parentNode&&(o.parentNode.removeChild(o),o=null),i&&i.parentNode&&(i.parentNode.removeChild(i),i=null)}}}();function C(e){return e?new Promise(function(t,n){try{T&&T.show_cursor&&T.show_cursor(),T&&T.click_element?(T.click_element(e),setTimeout(function(){t({success:!0})},1e3)):n(new Error("VirtualPointer not available"))}catch(e){n(e)}}):Promise.reject(new Error("Element is required"))}function O(){T&&T.show_cursor&&T.show_cursor()}function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function A(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return L(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(L(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,L(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,L(d,"constructor",u),L(u,"constructor",c),c.displayName="GeneratorFunction",L(u,o,"GeneratorFunction"),L(d),L(d,o,"Generator"),L(d,r,function(){return this}),L(d,"toString",function(){return"[object Generator]"}),(A=function(){return{w:i,m:f}})()}function L(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}L=function(e,t,n,r){function i(t,n){L(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},L(e,t,n,r)}function P(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function N(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,s,"next",e)}function s(e){P(i,r,o,a,s,"throw",e)}a(void 0)})}}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,D(r.key),r)}}function D(e){var t=function(e,t){if("object"!=j(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==j(t)?t:t+""}var M=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elementDiscovery=new x},t=[{key:"execute",value:(a=N(A().m(function e(t){var n,r;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t&&t.type){e.n=1;break}throw new Error("Invalid action: type is required");case 1:e.p=1,n=t.type,e.n="click"===n?2:"type"===n?4:"scroll"===n?6:8;break;case 2:return e.n=3,this._executeClick(t);case 3:case 5:case 7:return e.a(2,e.v);case 4:return e.n=5,this._executeType(t);case 6:return e.n=7,this._executeScroll(t);case 8:throw new Error("Unknown action type: ".concat(t.type));case 9:e.n=11;break;case 10:return e.p=10,r=e.v,e.a(2,{success:!1,error:r.message,action:t});case 11:return e.a(2)}},e,this,[[1,10]])})),function(e){return a.apply(this,arguments)})},{key:"_executeClick",value:(i=N(A().m(function e(t){var n;return A().w(function(e){for(;;)switch(e.n){case 0:if(n=this.elementDiscovery.findById(t.targetId)){e.n=1;break}throw new Error("Element not found: ".concat(t.targetId));case 1:return n.scrollIntoView({behavior:"smooth",block:"center"}),e.n=2,new Promise(function(e){return setTimeout(e,300)});case 2:return e.n=3,C(n);case 3:return e.a(2,{success:!0,action:t,element:{id:t.targetId,tag:n.tagName.toLowerCase(),text:(n.textContent||"").trim().slice(0,50)}})}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_executeType",value:(o=N(A().m(function e(t){var n,r,o,i,a,s,c,u;return A().w(function(e){for(;;)switch(e.n){case 0:if(n=this.elementDiscovery.findById(t.targetId)){e.n=1;break}throw new Error("Element not found: ".concat(t.targetId));case 1:if(t.value){e.n=2;break}throw new Error("Type action requires value");case 2:return n.scrollIntoView({behavior:"smooth",block:"center"}),e.n=3,new Promise(function(e){return setTimeout(e,300)});case 3:n.focus(),n.value="",r=String(t.value),o=0;case 4:if(!(o<r.length)){e.n=6;break}return i=r[o],a=new Event("input",{bubbles:!0}),s=new KeyboardEvent("keydown",{bubbles:!0,key:i,code:"Key".concat(i.toUpperCase())}),c=new KeyboardEvent("keyup",{bubbles:!0,key:i}),n.value+=i,n.dispatchEvent(s),n.dispatchEvent(a),n.dispatchEvent(c),e.n=5,new Promise(function(e){return setTimeout(e,50)});case 5:o++,e.n=4;break;case 6:return u=new Event("change",{bubbles:!0}),n.dispatchEvent(u),e.a(2,{success:!0,action:t,element:{id:t.targetId,tag:n.tagName.toLowerCase(),value:n.value}})}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"_executeScroll",value:(r=N(A().m(function e(t){var n;return A().w(function(e){for(;;)switch(e.n){case 0:if(!t.targetId){e.n=2;break}if(!(n=this.elementDiscovery.findById(t.targetId))){e.n=2;break}return n.scrollIntoView({behavior:"smooth",block:"center"}),e.n=1,new Promise(function(e){return setTimeout(e,500)});case 1:return e.a(2,{success:!0,action:t,element:{id:t.targetId,tag:n.tagName.toLowerCase()}});case 2:return window.scrollBy({top:.8*window.innerHeight,behavior:"smooth"}),e.n=3,new Promise(function(e){return setTimeout(e,500)});case 3:return e.a(2,{success:!0,action:t})}},e,this)})),function(e){return r.apply(this,arguments)})}],t&&F(e.prototype,t),n&&F(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,a}();function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function X(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return Y(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Y(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Y(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,Y(d,"constructor",u),Y(u,"constructor",c),c.displayName="GeneratorFunction",Y(u,o,"GeneratorFunction"),Y(d),Y(d,o,"Generator"),Y(d,r,function(){return this}),Y(d,"toString",function(){return"[object Generator]"}),(X=function(){return{w:i,m:f}})()}function Y(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Y=function(e,t,n,r){function i(t,n){Y(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},Y(e,t,n,r)}function R(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function G(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){R(i,r,o,a,s,"next",e)}function s(e){R(i,r,o,a,s,"throw",e)}a(void 0)})}}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,W(r.key),r)}}function W(e){var t=function(e,t){if("object"!=B(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==B(t)?t:t+""}var U=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isVisible=!1},t=[{key:"showAction",value:(o=G(X().m(function e(t){return X().w(function(e){for(;;)if(0===e.n)return this.isVisible||(O(),this.isVisible=!0),e.a(2,Promise.resolve())},e,this)})),function(e){return o.apply(this,arguments)})},{key:"guideAction",value:(r=G(X().m(function e(t){return X().w(function(e){for(;;)if(0===e.n)return this.isVisible||(O(),this.isVisible=!0),t.targetId&&this._highlightElement(t.targetId),e.a(2,Promise.resolve())},e,this)})),function(e){return r.apply(this,arguments)})},{key:"hide",value:function(){this.isVisible&&(T&&T.hide_cursor&&T.hide_cursor(),this.isVisible=!1),this._removeHighlights()}},{key:"_highlightElement",value:function(e){this._removeHighlights();var t=document.querySelector('[data-weblayer-id="'.concat(e,'"]'));if(t){if(t.classList.add("weblayer-acb-highlight"),!document.getElementById("weblayer-acb-styles")){var n=document.createElement("style");n.id="weblayer-acb-styles",n.textContent="\n                .weblayer-acb-highlight {\n                    outline: 3px solid #3b82f6 !important;\n                    outline-offset: 2px !important;\n                    box-shadow: 0 0 10px rgba(59, 130, 246, 0.5) !important;\n                    transition: outline 0.2s ease !important;\n                }\n            ",document.head.appendChild(n)}setTimeout(function(){t.classList.remove("weblayer-acb-highlight")},2e3)}}},{key:"_removeHighlights",value:function(){document.querySelectorAll(".weblayer-acb-highlight").forEach(function(e){e.classList.remove("weblayer-acb-highlight")})}}],t&&q(e.prototype,t),n&&q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o}();function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function K(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return V(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(V(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,V(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,V(d,"constructor",u),V(u,"constructor",c),c.displayName="GeneratorFunction",V(u,o,"GeneratorFunction"),V(d),V(d,o,"Generator"),V(d,r,function(){return this}),V(d,"toString",function(){return"[object Generator]"}),(K=function(){return{w:i,m:f}})()}function V(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}V=function(e,t,n,r){function i(t,n){V(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},V(e,t,n,r)}function z(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function J(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){z(i,r,o,a,s,"next",e)}function s(e){z(i,r,o,a,s,"throw",e)}a(void 0)})}}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Q(r.key),r)}}function Q(e){var t=function(e,t){if("object"!=H(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==H(t)?t:t+""}var Z=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.apiUrl=t||n.apiUrl||"https://api.weblayer.ai",this.orgId=r||n.org_id},t=[{key:"_getApiKey",value:function(){return null}},{key:"_request",value:(u=J(K().m(function e(t,n){var r,o,i,a;return K().w(function(e){for(;;)switch(e.p=e.n){case 0:return r="".concat(this.apiUrl).concat(t),e.p=1,e.n=2,fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":this._getApiKey()||""},body:JSON.stringify(n)});case 2:if((o=e.v).ok){e.n=4;break}return e.n=3,o.json().catch(function(){return{error:o.statusText}});case 3:throw i=e.v,new Error(i.error||"HTTP ".concat(o.status));case 4:return e.n=5,o.json();case 5:return e.a(2,e.v);case 6:throw e.p=6,a=e.v,console.error("[ACB] API request failed (".concat(t,"):"),a),a;case 7:return e.a(2)}},e,this,[[1,6]])})),function(e,t){return u.apply(this,arguments)})},{key:"start",value:(c=J(K().m(function e(t){var n,r,o,i,a;return K().w(function(e){for(;;)switch(e.n){case 0:return n=t.prompt,r=t.mode,o=t.inventory,i=t.sessionId,a=t.visitorId,e.n=1,this._request("/sdk/acb/start",{prompt:n,mode:r,inventory:o,sessionId:i,visitorId:a,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"continue",value:(s=J(K().m(function e(t){var n,r,o;return K().w(function(e){for(;;)switch(e.n){case 0:return n=t.threadId,r=t.result,o=t.inventory,e.n=1,this._request("/sdk/acb/continue",{threadId:n,result:r,inventory:o,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"pause",value:(a=J(K().m(function e(t){return K().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._request("/sdk/acb/pause",{threadId:t,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"resume",value:(i=J(K().m(function e(t){var n,r;return K().w(function(e){for(;;)switch(e.n){case 0:return n=t.threadId,r=t.inventory,e.n=1,this._request("/sdk/acb/resume",{threadId:n,inventory:r,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"stop",value:(o=J(K().m(function e(t){return K().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this._request("/sdk/acb/stop",{threadId:t,org_id:this.orgId});case 1:return e.a(2,e.v)}},e,this)})),function(e){return o.apply(this,arguments)})}],t&&$(e.prototype,t),r&&$(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,o,i,a,s,c,u}();function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ne(r.key),r)}}function ne(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ee(t)?t:t+""}var re=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentSession=null},(t=[{key:"createSession",value:function(e,t){if(this.currentSession&&"active"===this.currentSession.status)throw new Error("Session already active");return this.currentSession={threadId:null,prompt:e,mode:t,status:"active",actionsExecuted:0,startTime:Date.now(),pausedAt:null},this.currentSession}},{key:"getCurrentSession",value:function(){return this.currentSession}},{key:"isRunning",value:function(){return this.currentSession&&"active"===this.currentSession.status}},{key:"isPaused",value:function(){return this.currentSession&&"paused"===this.currentSession.status}},{key:"pause",value:function(e){e||(e=this.currentSession),e&&"active"===e.status&&(e.status="paused",e.pausedAt=Date.now())}},{key:"resume",value:function(e){e||(e=this.currentSession),e&&"paused"===e.status&&(e.status="active",e.pausedAt=null)}},{key:"stop",value:function(e){e||(e=this.currentSession),e&&(e.status="stopped")}},{key:"complete",value:function(e){e||(e=this.currentSession),e&&(e.status="completed")}},{key:"error",value:function(e,t){e||(e=this.currentSession),e&&(e.status="error",e.error=t)}},{key:"clearSession",value:function(){this.currentSession=null}}])&&te(e.prototype,t),n&&te(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return ae(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ae(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,ae(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,ae(d,"constructor",u),ae(u,"constructor",c),c.displayName="GeneratorFunction",ae(u,o,"GeneratorFunction"),ae(d),ae(d,o,"Generator"),ae(d,r,function(){return this}),ae(d,"toString",function(){return"[object Generator]"}),(ie=function(){return{w:i,m:f}})()}function ae(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ae=function(e,t,n,r){function i(t,n){ae(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},ae(e,t,n,r)}function se(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function ce(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){se(i,r,o,a,s,"next",e)}function s(e){se(i,r,o,a,s,"throw",e)}a(void 0)})}}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,le(r.key),r)}}function le(e){var t=function(e,t){if("object"!=oe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==oe(t)?t:t+""}var de=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config={apiUrl:t.apiUrl||n.apiUrl||"https://api.weblayer.ai",orgId:t.orgId||n.org_id,debug:t.debug||n.debug||!1},this.elementDiscovery=new x,this.actionExecutor=new M,this.visualFeedback=new U,this.llmClient=new Z(this.config.apiUrl,this.config.orgId),this.stateManager=new re},t=[{key:"updateOrgId",value:function(e){this.config.orgId=e,this.llmClient=new Z(this.config.apiUrl,e)}},{key:"acb",value:(c=ce(ie().m(function e(t){var n,r,o,i,a,s,c,u=arguments;return ie().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:"act",!this.stateManager.isRunning()){e.n=1;break}throw new Error("ACB already running. Stop or pause current session first.");case 1:if(t&&t.trim()){e.n=2;break}throw new Error("Prompt is required");case 2:if(["act","guide"].includes(n)){e.n=3;break}throw new Error('Mode must be "act" or "guide"');case 3:return this.config.debug&&console.log("[ACB] Starting ".concat(n," mode:"),t),r=this.stateManager.createSession(t,n),e.p=4,o=this.elementDiscovery.scan(),this.config.debug&&console.log("[ACB] Found ".concat(o.elements.length," interactive elements")),i=this._getSessionId(),a=this._getVisitorId(),e.n=5,this.llmClient.start({prompt:t,mode:n,inventory:o,sessionId:i,visitorId:a});case 5:return s=e.v,r.threadId=s.threadId,e.n=6,this._executionLoop(r,s.action,s.complete);case 6:return this.stateManager.complete(r),this.visualFeedback.hide(),e.a(2,{success:!0,threadId:r.threadId,status:"completed",actionsExecuted:r.actionsExecuted,duration:Date.now()-r.startTime});case 7:return e.p=7,c=e.v,this.stateManager.error(r,c),this.visualFeedback.hide(),e.a(2,{success:!1,threadId:r.threadId,status:"error",actionsExecuted:r.actionsExecuted,duration:Date.now()-r.startTime,error:c.message})}},e,this,[[4,7]])})),function(e){return c.apply(this,arguments)})},{key:"acbStop",value:(s=ce(ie().m(function e(){var t,n;return ie().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=this.stateManager.getCurrentSession()){e.n=1;break}return e.a(2,{success:!1,message:"No ACB session running"});case 1:return this.config.debug&&console.log("[ACB] Stopping session:",t.threadId),this.stateManager.stop(t),this.visualFeedback.hide(),e.p=2,e.n=3,this.llmClient.stop(t.threadId);case 3:e.n=5;break;case 4:e.p=4,n=e.v,this.config.debug&&console.warn("[ACB] Error notifying backend of stop:",n);case 5:return e.a(2,{success:!0,threadId:t.threadId,actionsExecuted:t.actionsExecuted,message:"Stopped by user"})}},e,this,[[2,4]])})),function(){return s.apply(this,arguments)})},{key:"acbPause",value:(a=ce(ie().m(function e(){var t,n;return ie().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=this.stateManager.getCurrentSession()){e.n=1;break}return e.a(2,{success:!1,message:"No ACB session running"});case 1:if("paused"!==t.status){e.n=2;break}return e.a(2,{success:!0,message:"Already paused"});case 2:return this.config.debug&&console.log("[ACB] Pausing session:",t.threadId),this.stateManager.pause(t),this.visualFeedback.hide(),e.p=3,e.n=4,this.llmClient.pause(t.threadId);case 4:e.n=6;break;case 5:e.p=5,n=e.v,this.config.debug&&console.warn("[ACB] Error notifying backend of pause:",n);case 6:return e.a(2,{success:!0,threadId:t.threadId,actionsExecuted:t.actionsExecuted,currentStep:t.actionsExecuted,message:"Paused"})}},e,this,[[3,5]])})),function(){return a.apply(this,arguments)})},{key:"acbResume",value:(i=ce(ie().m(function e(){var t,n,r;return ie().w(function(e){for(;;)switch(e.n){case 0:if(t=this.stateManager.getCurrentSession()){e.n=1;break}return e.a(2,{success:!1,message:"No paused ACB session"});case 1:if("paused"===t.status){e.n=2;break}return e.a(2,{success:!1,message:"ACB not paused"});case 2:return this.config.debug&&console.log("[ACB] Resuming session:",t.threadId),this.stateManager.resume(t),n=this.elementDiscovery.scan(),e.n=3,this.llmClient.resume({threadId:t.threadId,inventory:n});case 3:return r=e.v,e.n=4,this._executionLoop(t,r.action,r.complete);case 4:return e.a(2,{success:!0,threadId:t.threadId,message:"Resumed"})}},e,this)})),function(){return i.apply(this,arguments)})},{key:"getStatus",value:function(){var e=this.stateManager.getCurrentSession();return e?{running:!0,threadId:e.threadId,status:e.status,prompt:e.prompt,actionsExecuted:e.actionsExecuted,duration:Date.now()-e.startTime}:{running:!1}}},{key:"_executionLoop",value:(o=ce(ie().m(function e(t,n){var r,o,i,a,s,c,u,l=arguments;return ie().w(function(e){for(;;)switch(e.n){case 0:r=n,o=l.length>2&&void 0!==l[2]&&l[2];case 1:if(!r||o){e.n=13;break}if("stopped"!==t.status){e.n=2;break}return this.config.debug&&console.log("[ACB] Execution stopped"),e.a(3,13);case 2:if("paused"!==t.status){e.n=3;break}return this.config.debug&&console.log("[ACB] Execution paused"),e.a(3,13);case 3:if(!r.error){e.n=4;break}throw new Error("Action error: ".concat(r.error));case 4:if("act"!==t.mode){e.n=8;break}return e.n=5,this.visualFeedback.showAction(r);case 5:return e.n=6,this.actionExecutor.execute(r);case 6:return i=e.v,t.actionsExecuted++,i.success||this.config.debug&&console.warn("[ACB] Action failed:",i.error),a=this.elementDiscovery.scan(),e.n=7,this.llmClient.continue({threadId:t.threadId,result:{success:i.success,action:r,error:i.error,url:window.location.href},inventory:a});case 7:s=e.v,r=s.action,o=s.complete||!1,e.n=12;break;case 8:if("guide"!==t.mode){e.n=12;break}return e.n=9,this.visualFeedback.guideAction(r);case 9:return e.n=10,new Promise(function(e){return setTimeout(e,2e3)});case 10:return c=this.elementDiscovery.scan(),e.n=11,this.llmClient.continue({threadId:t.threadId,result:{guided:!0},inventory:c});case 11:u=e.v,r=u.action,o=u.complete||!1;case 12:e.n=1;break;case 13:this.visualFeedback.hide();case 14:return e.a(2)}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"_getSessionId",value:function(){return"undefined"!=typeof sessionStorage?sessionStorage.getItem("weblayer_session_id"):null}},{key:"_getVisitorId",value:function(){return this._getCookie("weblayer_visitor_id")}},{key:"_getCookie",value:function(e){if("undefined"==typeof document)return null;var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?t[2]:null}}],t&&ue(e.prototype,t),r&&ue(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,o,i,a,s,c}();function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ve(r.key),r)}}function ve(e){var t=function(e,t){if("object"!=fe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=fe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==fe(t)?t:t+""}function me(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,u=Object.create(c.prototype);return he(u,"_invoke",function(n,r,o){var i,s,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,s=0,c=e,f.n=n,a}};function p(n,r){for(s=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,i=l[t],p=f.p,v=i[2];n>3?(o=v===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(s=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,s=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,v){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,v),s=l,c=v;(t=s<2?e:c)||!d;){i||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,s=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,i),!0),u}var a={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(he(t={},r,function(){return this}),t),d=u.prototype=s.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,he(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=u,he(d,"constructor",u),he(u,"constructor",c),c.displayName="GeneratorFunction",he(u,o,"GeneratorFunction"),he(d),he(d,o,"Generator"),he(d,r,function(){return this}),he(d,"toString",function(){return"[object Generator]"}),(me=function(){return{w:i,m:f}})()}function he(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}he=function(e,t,n,r){function i(t,n){he(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},he(e,t,n,r)}function ye(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function ge(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){ye(i,r,o,a,s,"next",e)}function s(e){ye(i,r,o,a,s,"throw",e)}a(void 0)})}}var we=null;function be(){if(!we)try{we=new de({apiUrl:n.apiUrl||"https://api.weblayer.ai",orgId:n.org_id,debug:n.debug||!1})}catch(e){console.error("[weblayer] Failed to initialize ACB controller:",e)}return we}"undefined"!=typeof window&&(window.WEBLAYERSDK=window.WEBLAYERSDK||{},be(),window.WEBLAYERSDK.acb=function(){var e=ge(me().m(function e(t){var n,r,o=arguments;return me().w(function(e){for(;;)switch(e.n){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:"act",r=be()){e.n=1;break}throw new Error("ACB not available. Make sure WebLayerSDK.init() has been called with an orgId.");case 1:return e.n=2,r.acb(t,n);case 2:return e.a(2,e.v)}},e)}));return function(t){return e.apply(this,arguments)}}(),window.WEBLAYERSDK.acbStop=ge(me().m(function e(){var t;return me().w(function(e){for(;;)switch(e.n){case 0:if(t=be()){e.n=1;break}throw new Error("ACB not available. Make sure WebLayerSDK.init() has been called with an orgId.");case 1:return e.n=2,t.acbStop();case 2:return e.a(2,e.v)}},e)})),window.WEBLAYERSDK.acbPause=ge(me().m(function e(){var t;return me().w(function(e){for(;;)switch(e.n){case 0:if(t=be()){e.n=1;break}throw new Error("ACB not available. Make sure WebLayerSDK.init() has been called with an orgId.");case 1:return e.n=2,t.acbPause();case 2:return e.a(2,e.v)}},e)})),window.WEBLAYERSDK.acbResume=ge(me().m(function e(){var t;return me().w(function(e){for(;;)switch(e.n){case 0:if(t=be()){e.n=1;break}throw new Error("ACB not available. Make sure WebLayerSDK.init() has been called with an orgId.");case 1:return e.n=2,t.acbResume();case 2:return e.a(2,e.v)}},e)})),window.WEBLAYERSDK.acbStatus=function(){var e=be();return e?e.getStatus():{running:!1,error:"ACB not available"}});var _e=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r=[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){n.org_id=e,n.apiUrl=t.apiUrl||n.apiUrl||"https://api.weblayer.ai",n.debug=t.debug||!1,n.weblayerEnabled=!1!==t.weblayerEnabled,n.debug&&(console.log("[weblayer] Initializing WebLayer SDK with orgId:",e),console.log("[weblayer] API URL:",n.apiUrl));var r=o();if(r){n.debug&&console.log("[weblayer] Visitor ID:",r);try{b(r)}catch(e){console.error("[weblayer] Failed to initialize tracking:",e)}if("undefined"!=typeof window&&we)try{we.updateOrgId(n.org_id),we.config.apiUrl=n.apiUrl,we.config.debug=n.debug,n.debug&&console.log("[weblayer] ACB module updated with orgId:",n.org_id)}catch(e){console.error("[weblayer] Failed to update ACB controller:",e)}}else console.error("[weblayer] Failed to create visitor ID")}else console.error("[weblayer] orgId is required")}}],(t=null)&&pe(e.prototype,t),r&&pe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();"undefined"!=typeof window&&(window.WebLayerSDK=_e,function(){var e=document.currentScript;if(!e)for(var t=document.getElementsByTagName("script"),n=t.length-1;n>=0;n--){var r=t[n],o=r.src||"";if(o.includes("weblayer-sdk")||o.includes("sdk.weblayer.ai")){e=r;break}}if(e){var i=null;try{var a=new URL(e.src),s=a.pathname.split("/").filter(function(e){return e.length>0});s.length>0&&a.hostname.includes("sdk.weblayer.ai")&&(i=s[s.length-1])}catch(t){var c=e.src||"";if(c.includes("sdk.weblayer.ai/")){var u=c.match(/sdk\.weblayer\.ai\/([^\/\?#]+)/);u&&u[1]&&(i=u[1])}}i||(i=e.getAttribute("data-org-id")),i&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){_e.init(i)}):_e.init(i))}}());const Se=_e;window.WebLayerSDK=t})();